<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PHCM9795: Foundations of Biostatistics - 2&nbsp; Probability and probability distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-comparing-two-means.html" rel="next">
<link href="./_revision-progress.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #ffdc00;
      }
</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-probability.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability and probability distributions</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability and probability distributions</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PHCM9795: Foundations of Biostatistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./_revision-progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">_revision-progress.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-probability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability and probability distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-comparing-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Comparing the means of two groups</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summary statistics for binary data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-testing-proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hypothesis testing for categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-correlation-and-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Correlation and simple linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98.1-appendix1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning objectives</a></li>
  <li><a href="#optional-readings" id="toc-optional-readings" class="nav-link" data-scroll-target="#optional-readings">Optional readings</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2.1</span> Introduction</a></li>
  <li><a href="#probability" id="toc-probability" class="nav-link" data-scroll-target="#probability"><span class="header-section-number">2.2</span> Probability</a>
  <ul class="collapse">
  <li><a href="#additive-law-of-probability" id="toc-additive-law-of-probability" class="nav-link" data-scroll-target="#additive-law-of-probability"><span class="header-section-number">2.2.1</span> Additive law of probability</a></li>
  <li><a href="#multiplicative-law-of-probability" id="toc-multiplicative-law-of-probability" class="nav-link" data-scroll-target="#multiplicative-law-of-probability"><span class="header-section-number">2.2.2</span> Multiplicative law of probability</a></li>
  </ul></li>
  <li><a href="#probability-distributions" id="toc-probability-distributions" class="nav-link" data-scroll-target="#probability-distributions"><span class="header-section-number">2.3</span> Probability distributions</a></li>
  <li><a href="#discrete-random-variables-and-their-probability-distributions" id="toc-discrete-random-variables-and-their-probability-distributions" class="nav-link" data-scroll-target="#discrete-random-variables-and-their-probability-distributions"><span class="header-section-number">2.4</span> Discrete random variables and their probability distributions</a></li>
  <li><a href="#binomial-distribution" id="toc-binomial-distribution" class="nav-link" data-scroll-target="#binomial-distribution"><span class="header-section-number">2.5</span> Binomial distribution</a>
  <ul class="collapse">
  <li><a href="#mean-and-variance-of-a-binomial-variable" id="toc-mean-and-variance-of-a-binomial-variable" class="nav-link" data-scroll-target="#mean-and-variance-of-a-binomial-variable"><span class="header-section-number">2.5.1</span> Mean and variance of a binomial variable</a></li>
  </ul></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution"><span class="header-section-number">2.6</span> Normal distribution</a></li>
  <li><a href="#the-standard-normal-distribution" id="toc-the-standard-normal-distribution" class="nav-link" data-scroll-target="#the-standard-normal-distribution"><span class="header-section-number">2.7</span> The Standard Normal distribution</a></li>
  <li><a href="#assessing-normality" id="toc-assessing-normality" class="nav-link" data-scroll-target="#assessing-normality"><span class="header-section-number">2.8</span> Assessing Normality</a>
  <ul class="collapse">
  <li><a href="#skewness-and-kurtosis" id="toc-skewness-and-kurtosis" class="nav-link" data-scroll-target="#skewness-and-kurtosis"><span class="header-section-number">2.8.1</span> Skewness and kurtosis</a></li>
  </ul></li>
  <li><a href="#non-normally-distributed-measurements" id="toc-non-normally-distributed-measurements" class="nav-link" data-scroll-target="#non-normally-distributed-measurements"><span class="header-section-number">2.9</span> Non-Normally distributed measurements</a>
  <ul class="collapse">
  <li><a href="#which-measure-of-central-tendency-to-use" id="toc-which-measure-of-central-tendency-to-use" class="nav-link" data-scroll-target="#which-measure-of-central-tendency-to-use"><span class="header-section-number">2.9.1</span> Which measure of central tendency to use</a></li>
  </ul></li>
  <li><a href="#parametric-and-non-parametric-statistical-methods" id="toc-parametric-and-non-parametric-statistical-methods" class="nav-link" data-scroll-target="#parametric-and-non-parametric-statistical-methods"><span class="header-section-number">2.10</span> Parametric and non-parametric statistical methods</a></li>
  <li><a href="#other-types-of-probability-distributions" id="toc-other-types-of-probability-distributions" class="nav-link" data-scroll-target="#other-types-of-probability-distributions"><span class="header-section-number">2.11</span> Other types of probability distributions</a></li>
  <li><a href="#stata-notes" id="toc-stata-notes" class="nav-link" data-scroll-target="#stata-notes">Stata notes</a>
  <ul class="collapse">
  <li><a href="#importing-data-into-stata" id="toc-importing-data-into-stata" class="nav-link" data-scroll-target="#importing-data-into-stata"><span class="header-section-number">2.12</span> Importing data into Stata</a>
  <ul class="collapse">
  <li><a href="#importing-plain-text-data-into-stata" id="toc-importing-plain-text-data-into-stata" class="nav-link" data-scroll-target="#importing-plain-text-data-into-stata"><span class="header-section-number">2.12.1</span> Importing plain text data into Stata</a></li>
  </ul></li>
  <li><a href="#checking-your-data-for-errors-in-stata" id="toc-checking-your-data-for-errors-in-stata" class="nav-link" data-scroll-target="#checking-your-data-for-errors-in-stata"><span class="header-section-number">2.13</span> Checking your data for errors in Stata</a></li>
  <li><a href="#overlaying-a-normal-curve-on-a-histogram" id="toc-overlaying-a-normal-curve-on-a-histogram" class="nav-link" data-scroll-target="#overlaying-a-normal-curve-on-a-histogram"><span class="header-section-number">2.14</span> Overlaying a Normal curve on a Histogram</a></li>
  <li><a href="#descriptive-statistics-for-checking-normality" id="toc-descriptive-statistics-for-checking-normality" class="nav-link" data-scroll-target="#descriptive-statistics-for-checking-normality"><span class="header-section-number">2.15</span> Descriptive statistics for checking normality</a></li>
  <li><a href="#importing-excel-data-into-stata" id="toc-importing-excel-data-into-stata" class="nav-link" data-scroll-target="#importing-excel-data-into-stata"><span class="header-section-number">2.16</span> Importing Excel data into Stata</a></li>
  <li><a href="#generating-new-variables" id="toc-generating-new-variables" class="nav-link" data-scroll-target="#generating-new-variables"><span class="header-section-number">2.17</span> Generating new variables</a></li>
  <li><a href="#summarising-data-by-another-variable" id="toc-summarising-data-by-another-variable" class="nav-link" data-scroll-target="#summarising-data-by-another-variable"><span class="header-section-number">2.18</span> Summarising data by another variable</a></li>
  <li><a href="#recoding-data" id="toc-recoding-data" class="nav-link" data-scroll-target="#recoding-data"><span class="header-section-number">2.19</span> Recoding data</a></li>
  <li><a href="#computing-binomial-probabilities-using-the-hand-calculator-in-stata" id="toc-computing-binomial-probabilities-using-the-hand-calculator-in-stata" class="nav-link" data-scroll-target="#computing-binomial-probabilities-using-the-hand-calculator-in-stata"><span class="header-section-number">2.20</span> Computing binomial probabilities using the Hand calculator in Stata</a></li>
  <li><a href="#computing-probabilities-from-the-normal-distribution-using-the-hand-calculator-in-stata" id="toc-computing-probabilities-from-the-normal-distribution-using-the-hand-calculator-in-stata" class="nav-link" data-scroll-target="#computing-probabilities-from-the-normal-distribution-using-the-hand-calculator-in-stata"><span class="header-section-number">2.21</span> Computing probabilities from the normal distribution using the Hand calculator in Stata</a></li>
  </ul></li>
  <li><a href="#r-notes" id="toc-r-notes" class="nav-link" data-scroll-target="#r-notes">R notes</a>
  <ul class="collapse">
  <li><a href="#importing-data-into-r" id="toc-importing-data-into-r" class="nav-link" data-scroll-target="#importing-data-into-r"><span class="header-section-number">2.22</span> Importing data into R</a>
  <ul class="collapse">
  <li><a href="#importing-plain-text-data-into-r" id="toc-importing-plain-text-data-into-r" class="nav-link" data-scroll-target="#importing-plain-text-data-into-r"><span class="header-section-number">2.22.1</span> Importing plain text data into R</a></li>
  </ul></li>
  <li><a href="#checking-your-data-for-errors-in-r" id="toc-checking-your-data-for-errors-in-r" class="nav-link" data-scroll-target="#checking-your-data-for-errors-in-r"><span class="header-section-number">2.23</span> Checking your data for errors in R</a>
  <ul class="collapse">
  <li><a href="#what-on-earth" id="toc-what-on-earth" class="nav-link" data-scroll-target="#what-on-earth"><span class="header-section-number">2.23.1</span> What on earth: == ?</a></li>
  </ul></li>
  <li><a href="#overlaying-a-normal-curve-on-a-histogram-1" id="toc-overlaying-a-normal-curve-on-a-histogram-1" class="nav-link" data-scroll-target="#overlaying-a-normal-curve-on-a-histogram-1"><span class="header-section-number">2.24</span> Overlaying a Normal curve on a histogram</a></li>
  <li><a href="#descriptive-statistics-for-checking-normality-1" id="toc-descriptive-statistics-for-checking-normality-1" class="nav-link" data-scroll-target="#descriptive-statistics-for-checking-normality-1"><span class="header-section-number">2.25</span> Descriptive statistics for checking normality</a></li>
  <li><a href="#importing-excel-data-into-r" id="toc-importing-excel-data-into-r" class="nav-link" data-scroll-target="#importing-excel-data-into-r"><span class="header-section-number">2.26</span> Importing Excel data into R</a></li>
  <li><a href="#generating-new-variables-1" id="toc-generating-new-variables-1" class="nav-link" data-scroll-target="#generating-new-variables-1"><span class="header-section-number">2.27</span> Generating new variables</a></li>
  <li><a href="#summarising-data-by-another-variable-1" id="toc-summarising-data-by-another-variable-1" class="nav-link" data-scroll-target="#summarising-data-by-another-variable-1"><span class="header-section-number">2.28</span> Summarising data by another variable</a></li>
  <li><a href="#summarising-a-single-column-of-data" id="toc-summarising-a-single-column-of-data" class="nav-link" data-scroll-target="#summarising-a-single-column-of-data"><span class="header-section-number">2.29</span> Summarising a single column of data</a></li>
  <li><a href="#plotting-data-by-another-variable" id="toc-plotting-data-by-another-variable" class="nav-link" data-scroll-target="#plotting-data-by-another-variable"><span class="header-section-number">2.30</span> Plotting data by another variable</a></li>
  <li><a href="#sec-recoding-data" id="toc-sec-recoding-data" class="nav-link" data-scroll-target="#sec-recoding-data"><span class="header-section-number">2.31</span> Recoding data</a></li>
  <li><a href="#computing-binomial-probabilities-using-r" id="toc-computing-binomial-probabilities-using-r" class="nav-link" data-scroll-target="#computing-binomial-probabilities-using-r"><span class="header-section-number">2.32</span> Computing binomial probabilities using R</a></li>
  <li><a href="#computing-probabilities-from-a-normal-distribution" id="toc-computing-probabilities-from-a-normal-distribution" class="nav-link" data-scroll-target="#computing-probabilities-from-a-normal-distribution"><span class="header-section-number">2.33</span> Computing probabilities from a Normal distribution</a></li>
  </ul></li>
  <li><a href="#activities" id="toc-activities" class="nav-link" data-scroll-target="#activities">Activities</a>
  <ul class="collapse">
  <li><a href="#activity-2.1" id="toc-activity-2.1" class="nav-link" data-scroll-target="#activity-2.1">Activity 2.1</a></li>
  <li><a href="#activity-2.2" id="toc-activity-2.2" class="nav-link" data-scroll-target="#activity-2.2">Activity 2.2</a></li>
  <li><a href="#activity-2.3" id="toc-activity-2.3" class="nav-link" data-scroll-target="#activity-2.3">Activity 2.3</a></li>
  <li><a href="#activity-2.4" id="toc-activity-2.4" class="nav-link" data-scroll-target="#activity-2.4">Activity 2.4</a></li>
  <li><a href="#activity-2.5" id="toc-activity-2.5" class="nav-link" data-scroll-target="#activity-2.5">Activity 2.5</a></li>
  <li><a href="#activity-2.6" id="toc-activity-2.6" class="nav-link" data-scroll-target="#activity-2.6">Activity 2.6</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="learning-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<p>By the end of this module you will be able to:</p>
<ul>
<li>Describe the concept of probability;</li>
<li>Describe the characteristics of a binomial distribution and a Normal distribution;</li>
<li>Compute binomial probabilities using Stata;</li>
<li>Compute and use Z-scores to obtain probabilities;</li>
<li>Decide when to use parametric or non-parametric statistical methods;</li>
<li>Briefly outline other types of distributions.</li>
</ul>
</section>
<section id="optional-readings" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="optional-readings">Optional readings</h2>
<p><span class="citation" data-cites="kirkwood_sterne01">Kirkwood and Sterne (<a href="references.html#ref-kirkwood_sterne01" role="doc-biblioref">2001</a>)</span>; Chapters 5, 14 and 15. <a href="http://er1.library.unsw.edu.au/er/cgi-bin/eraccess.cgi?url=https://ebookcentral.proquest.com/lib/unsw/detail.action?docID=624728">[UNSW Library Link]</a></p>
<p><span class="citation" data-cites="bland15">Bland (<a href="references.html#ref-bland15" role="doc-biblioref">2015</a>)</span>; Chapters 6 and 7. <a href="http://er1.library.unsw.edu.au/er/cgi-bin/eraccess.cgi?url=https://ebookcentral.proquest.com/lib/unsw/detail.action?docID=5891730">[UNSW Library Link]</a></p>
</section>
<section id="introduction" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">2.1</span> Introduction</h2>
<p>In Module 1, we looked at how to summarise data numerically and graphically. In this module, we will introduce the concept of probability which underpins the theoretical basis of statistics, and then introduce the concept of probability distributions. We will look at the binomial distribution, and then look at the most important distribution in statistics: the Normal distribution. Finally, we introduce some other probability distributions commonly used in biostatistics.</p>
</section>
<section id="probability" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="probability"><span class="header-section-number">2.2</span> Probability</h2>
<p>Probability is defined as:</p>
<blockquote class="blockquote">
<p>the chance of an event occurring, where an event is the result of an observation or experiment, or the description of some potential outcome.</p>
</blockquote>
<p>Probabilities range from 0 (where the event will never occur) to 1 (where the event will always occur). For example, tossing a coin is an experiment; one event is the coin landing with head up, while the other event is the coin landing tails up. The set of all possible outcomes in an experiment is called the sample space. For example, by tossing a coin you can get either a head or a tail (called mutually exclusive events); and by rolling a die you can get any of the six sides. Thus, for a die the sampling space is: S = {1, 2, 3, 4, 5, 6}</p>
<p>With a fair (unbiased) die, the probability of each outcome occurring is 1/6 and its probability distribution is simply a probability of 1/6 for each of the six numbers on a die.</p>
<section id="additive-law-of-probability" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="additive-law-of-probability"><span class="header-section-number">2.2.1</span> Additive law of probability</h3>
<p>How do we work out the probability that one roll of a die will turn out to be a 3 or a 6? To do that, we first need to work out whether the events (3 or 6 on the roll of a die) are mutually exclusive. Events are mutually exclusive if they are events which cannot occur at the same time. For example, rolling a die once and getting a 3 and 6 are mutually exclusive events (you can roll one or the other but not both in a single roll).</p>
<p>To obtain the probability of one or the other of two mutually exclusive events occurring, the sum of the probabilities of each is taken. For example, the probability of the roll of a die being a 3 or a 6 is the sum of the probability of the die being 3 (i.e.&nbsp;1/6) and the probability of the die being 6 (also 1/6). With a fair die:</p>
<p>Probability of a die roll being 3 or 6 = <span class="math inline">\(1/6 + 1/6 = 1/3\)</span></p>
<p>Another way of putting it is:</p>
<p>P(die roll =3 or die roll =6) = P(die roll=3) + P(die roll=6) = <span class="math inline">\(1/6 + 1/6 = 1/3\)</span></p>
<section id="example-additive-law-for-mutually-exclusive-events" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-additive-law-for-mutually-exclusive-events">Example: Additive law for mutually exclusive events</h4>
<p>Consider that blood type can be organised into the ABO system (blood types A, B, AB or O) An individual may only have one blood type.</p>
<p>Using the information from https://www.donateblood.com.au/learn/about-blood let’s consider the ABO blood type system. The frequency distribution (prevalence) of the ABO blood type system in the population represents the probability of each of the outcomes. If we consider all possible blood type outcomes, then the total of the probabilities will sum to 1 (100%).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-2-1" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 60%; margin-left: auto; margin-right: auto;  " id="tab:tbl-2-1"><caption>Table&nbsp;2.1:  <p>Frequency of blood types</p> </caption>
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Blood Type</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">% of population</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Probability&nbsp;&nbsp;&nbsp;</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">38%</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.38</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">B</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">10%</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.1&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">AB</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3%</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.03</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">O</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">49%</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.49</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Total</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">100%</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1&nbsp;&nbsp;&nbsp;</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>In this example we consider: What is the probability that an individual will have either blood group O or A?</p>
<p>Since blood type is mutually exclusive, the probability that either one or the other occurs is the sum of the individual probabilities. These are mutually exclusive events so we can say P(O or A) = P(O) + P(A)</p>
<p>Thus, the answer is: P(Blood type O) + P(Blood type A) = 0.49 + 0.38 = 0.87</p>
</section>
</section>
<section id="multiplicative-law-of-probability" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="multiplicative-law-of-probability"><span class="header-section-number">2.2.2</span> Multiplicative law of probability</h3>
<p>The additive law of probability lets us consider the probability of different outcomes in a single experiment. The multiplicative law lets us consider the probability of multiple events occurring in a particular order. For example: if I roll a die twice, what is the probability of rolling a 3 and <em>then</em> a 6?</p>
<p>These events are independent: the probability of rolling a 6 on the second roll is not affected by the first roll.</p>
<p>The multiplicative law of probability states:</p>
<blockquote class="blockquote">
<p>If A and B are independent, then P(A and B) = P(A) <span class="math inline">\(\times\)</span> P(B).</p>
</blockquote>
<p>So, the probability of rolling a 3 and then a 6 is: P(3 and 6) = <span class="math inline">\(1/6 \times 1/6 = 1/36\)</span>.</p>
<p>Note here that the order matters – we are considering the probability of rolling a 3 and then a 6, not the probability of rolling a 6 and then a 3.</p>
</section>
</section>
<section id="probability-distributions" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="probability-distributions"><span class="header-section-number">2.3</span> Probability distributions</h2>
<blockquote class="blockquote">
<p>A probability distribution is a table or a function that provides the probabilities of all possible outcomes for a random event.</p>
</blockquote>
<p>For example, the probability distribution for a single coin toss is straightforward: the probability of obtaining a head is 0.5, and the probability of obtaining a tail is 0.5, and this can be summarised in <a href="#tbl-coin">Table&nbsp;<span>2.2</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-coin" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 50%; margin-left: auto; margin-right: auto;  " id="tab:tbl-coin"><caption>Table&nbsp;2.2:  <p>Probability distribution for a single coin toss</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Coin face</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Probability</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Heads</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.5</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Tails</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.5</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Similarly, the probability distribution for a single roll of a die is straightforward: each face has a probability of 1/6 (<a href="#tbl-die">Table&nbsp;<span>2.3</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-die" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 50%; margin-left: auto; margin-right: auto;  " id="tab:tbl-die"><caption>Table&nbsp;2.3:  <p>Probability distributions for a single roll of a die</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Face of a die</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Probability</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/6</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/6</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/6</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/6</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/6</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/6</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Things become more complicated when we consider multiple coin-tosses, or rolls of a die. These series of events can be summarised by considering the number of times a certain outcome is observed. For example, the probability of obtaining three heads from five coin tosses.</p>
<p>Probability distributions can be used in two main ways:</p>
<ol type="1">
<li>To calculate the probability of an event occurring. This seems trivial for the coin-toss and die-roll examples above. However, we can consider more complex events, as below.</li>
<li>To understand the behaviour of a sample statistic. We will see in Modules 3 and 4 that we can assume the mean of a sample follows a probability distribution. We can obtain useful information about the sample mean by using properties of the probability distribution.</li>
</ol>
</section>
<section id="discrete-random-variables-and-their-probability-distributions" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="discrete-random-variables-and-their-probability-distributions"><span class="header-section-number">2.4</span> Discrete random variables and their probability distributions</h2>
<p>Rather than thinking of random events, we often use the term <em>random variable</em> to describe a quantity that can have different values determined by chance.</p>
<p>A <em>discrete random variable</em> is a random variable that can take on only countable values (that is, non-negative whole numbers). An example of a discrete random variable is the number of heads observed in a series of coin tosses.</p>
<p>A discrete random variable can be summarised by listing all the possible values that the variable can take. As defined earlier, a table, formula or graph that presents these possible values, and their associated probabilities, is called a probability distribution.</p>
<p>Example: let’s consider the number of heads in a series of three coin tosses. We might observe 0 heads, or 1 head, or 2, or 3 heads. If we let X denote the number of heads in a series of three coin tosses, then possible values of X are 0, 1, 2 or 3.</p>
<p>We write the probability of observing x heads as P(X=x). So P(X=0) is the probability that the three tosses has no heads. Similarly, P(X=1) is the probability of observing one head.</p>
<p>The possible combinations for three coin tosses are as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-2-3toss" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 60%; margin-left: auto; margin-right: auto;  " id="tab:tbl-2-3toss"><caption>Table&nbsp;2.4:  <p>The number of heads from three coin tosses</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Pattern</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Number of heads</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Tail, Tail, Tail</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Head, Tail, Tail</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Tail, Head, Tail</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Tail, Tail, Head</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Head, Head, Tail</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Head, Tail, Head</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">2</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Tail, Head, Head</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Head, Head, Head</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">3</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>There are eight possible outcomes from three coin tosses (permutations). If we assume an equal chance of observing a head or a tail, each permutation above is equally likely, and so has a probability of 1/8.</p>
<p>If we consider the possibility of observing just one head out of the three tosses, this can happen in three ways (HTT, THT, TTH). So the probability of observing one head is calculated using the additive law: P(X=1) = <span class="math inline">\(\tfrac{1}{8} + \tfrac{1}{8} + \tfrac{1}{8} = \tfrac{3}{8}\)</span>.</p>
<p>Therefore, the probability distribution for X, the number of heads from three coin tosses, is as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-2-4" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 60%; margin-left: auto; margin-right: auto;  " id="tab:tbl-2-4"><caption>Table&nbsp;2.5:  <p>Probability distribution for the number of heads from three coin
tosses</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">x (number of heads observed)</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">P(X=x)</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/8</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/8 + 1/8 + 1/8 = 3/8</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/8 + 1/8 + 1/8 = 3/8</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1/8</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>Note that the probabilities sum to 1.</p>
<p>The above example was based on a coin toss, where flipping a head or a tail is equally likely (both have probabilities of 0.5). Let’s consider a case where the probability of an event is not equal to 0.5: having blood type A.</p>
<p>From <a href="#tbl-2-1">Table&nbsp;<span>2.1</span></a>, the probability that a person has Type A blood is 0.38, and therefore, the probability that a person does not have Type A blood is 0.62 (1–0.38). If we considered taking a random sample of three people, the probability that all three would have Type A blood is 0.38 × 0.38 × 0.38 (using the multiplicative rule above) – and there is only one way this could happen.</p>
<p>The number of ways two people out of three could have Type A blood is 3, and each permutation is listed in <a href="#tbl-2-5">Table&nbsp;<span>2.6</span></a>. The probability of observing each of the three patterns is the same, and can be calculated using the multiplicative rule: 0.38 × 0.38 × 0.62 = 0.0895.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-2-5" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 80%; margin-left: auto; margin-right: auto;  " id="tab:tbl-2-5"><caption>Table&nbsp;2.6:  <p>Combinations and probabilities of Type A blood in three people</p> </caption>
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Person 1</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Person 2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Person 3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Probability</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.38 × 0.38 × 0.38 = 0.0549</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.38 × 0.38 × 0.62 = 0.0895</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.38 × 0.62 × 0.38 = 0.0895</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.62 × 0.38 × 0.38 = 0.0895</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.38 × 0.62 × 0.62 = 0.1461</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.62 × 0.38 × 0.62 = 0.1461</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.62 × 0.62 × 0.38 = 0.1461</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Not A</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.62 × 0.62 × 0.62 = 0.2383</td></tr>
</tbody></table>

</div>
</div>
</div>
<p><a href="#tbl-2-6">Table&nbsp;<span>2.7</span></a> gives the probability of each of the blood type combinations we could observe in three people. The probability of observing a certain number of people (say, k) with Type A blood from a sample of three people can be calculated by summing the combinations:</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-2-6" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 80%; margin-left: auto; margin-right: auto;  " id="tab:tbl-2-6"><caption>Table&nbsp;2.7:  <p>Probabilities of observing numbers of people with Type A blood in a
sample of three people</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Number of people with Type A blood</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Probability of each pattern&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0549</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0895 + 0.0895 + 0.0895 = 0.2689</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.1461 + 0.1461 + 0.1461 = 0.4382</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.2383</td></tr>
</tbody></table>

</div>
</div>
</div>
</section>
<section id="binomial-distribution" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="binomial-distribution"><span class="header-section-number">2.5</span> Binomial distribution</h2>
<p>The above are examples of the binomial distribution. The binomial distribution is used when we have a collection of random events, where each random event is binary (e.g.&nbsp;Heads vs Tails, Type A blood vs Not Type A blood, Infected vs Not infected). The binomial distribution calculates (in general terms):</p>
<ul>
<li>the probability of observing k successes</li>
<li>from a collection of n trials</li>
<li>where the probability of a success in one trial is p.</li>
</ul>
<p>The terms used here can be defined as: - a success is simply an event of interest from a binary random event. In the coin-toss example, “success” was tossing a Head. In the blood type example, we were only interested in whether someone was Type A or not Type A, so “success” was a blood of Type A. We tend to use the word “success” to mean “an event of interest”, and “failure” as “an event not of interest”. - the number of trials refers to the number of random events observed. In both examples, we observed three events (three coin tosses, three people). - the probability of a success (p) simply refers to the probability of the event of interest. In the coin toss example, this was the probability of tossing a Heads (=0.5); for the blood-type example, this was the probability of having Type A blood (0.38).</p>
<p>Putting all this together, we say that we have a binomial experiment. To satisfy the assumptions of a binomial distribution, our experiment must satisfy the following criteria:</p>
<ol type="1">
<li>The experiment consists of fixed number (n) of trials.</li>
<li>The result of each trial falls into only one of two categories – the event occurred (“success”) or the event did not occur (“failure”).</li>
<li>The probability, p, of the event occurring remains constant for each trial.</li>
<li>Each trial of the experiment is independent of the other trials.</li>
</ol>
<p>We have shown in the examples above how we can calculate the probabilities for small experiments (n=3). Once n becomes large, constructing such probability distribution tables becomes difficult. The general formula for calculating the probability of observing k successes from n trials, where each trial has a probability of success of p is given by:</p>
<p><span class="math display">\[ P(X=k) = \frac{n!}{k! (n-k)!} \times p^k \times (1-p)^{n-k} \]</span></p>
<p>where <span class="math inline">\(n! = n \times (n-1) \times (n-2) \times \dots \times 2 \times 1\)</span>.</p>
<p><strong>Note that this formula is almost never calculated by hand.</strong> Instructions for calculating binomial probabilities are given in the Stata and R notes at the end of this Module.</p>
<section id="mean-and-variance-of-a-binomial-variable" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="mean-and-variance-of-a-binomial-variable"><span class="header-section-number">2.5.1</span> Mean and variance of a binomial variable</h3>
<p>The properties of the binomial distribution are useful in the statistical modelling of prevalence data. If <em>X</em> has a binomial distribution, then the mean of <em>X</em> is:</p>
<p><span class="math display">\[ E(X) = n \times p\]</span> and the variance is:</p>
<p><span class="math display">\[ var(X) = n \times p \times (1-p) \]</span> where <em>n</em> = the number of trials, and <em>p</em> = the probability of the event occurring (or success).</p>
<section id="worked-example" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="worked-example">Worked example</h4>
<p>A population-based survey conducted by the AIHW (2008) of a random sample of the Australian population estimated that in 2007, 19.8% of the Australian population were current smokers.</p>
<ol type="a">
<li>From a random sample of 6 people from the Australian population in 2007, what is the probability that 3 of them will be smokers?</li>
<li>What is the probability that among the six persons, at least 4 will be smokers?</li>
<li>What is the probability that at most, 2 will be smokers?</li>
</ol>
</section>
<section id="stata-solution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="stata-solution">Stata Solution</h4>
<ol type="a">
<li>The computation for binomial probabilities can be done using Stata from the main menu <strong>Data &gt; Other utilities &gt; Hand calculator</strong> as shown in the Stata Notes section.</li>
</ol>
<p>Of the three binomial functions in the Hand Calculator, we choose the <code>binomialp</code> function, which gives “the probability of observing k successes in n trials when the probability of a success on one trial is p”.</p>
<p>We complete the function using n=6, k=3, and p=0.198. This gives an answer of 0.08. [Command: <code>display binomialp(6, 4, 0.198)</code>]</p>
<ol start="2" type="a">
<li>In common language, getting “at least 4” smokers means getting 4, 5 or 6 smokers. Since these are mutually exclusive events, we can apply the additive law to find the probability of getting at least 4 smokers:</li>
</ol>
<p><span class="math display">\[ P(X \ge 4) = P(X=4) + P(X=5) + P(X=6) \]</span> Using the same binomial probability function as in the previous question,</p>
<ul>
<li>P(X=4) = 0.015 [Command: <code>display binomialp(6, 4, 0.198)</code>]</li>
<li>P(X=5) = 0.001 [Command: <code>display binomialp(6, 5, 0.198)</code>]</li>
<li>P(X=6) = 0.00006 [Command: <code>display binomialp(6, 6, 0.198)</code>]</li>
</ul>
<p>Answer: <span class="math inline">\(P(X \ge 4) = 0.00006025 + 0.00146437 + 0.0148282 = 0.016\)</span></p>
<p>Alternatively, we can use the <code>binomialtail</code> function (which gives “the probability of observing k or more successes in n trials when the probability of a success on one trial is p”).</p>
<p>Here, n=6, k=4 and p=0.198, giving the same answer as above: 0.016. [Command: <code>display binomialtail(6, 4, 0.198)</code>]</p>
<ol start="3" type="a">
<li>Observing at most two means observing 0, 1 or 2 smokers. Therefore, the probability of observing at most 2 smokers is:</li>
</ol>
<ul>
<li>P(X <span class="math inline">\(\le\)</span> 2) = P(X=0) + P(X=1) + P(X=2)</li>
<li>P(X=0) = 0.266 [Command: <code>display binomialp(6,0,.198)</code>]</li>
<li>P(X=1) = 0.394 [Command: <code>display binomialp(6,1,.198)</code>]</li>
<li>P(X=2) = 0.243 [Command: <code>display binomialp(6,2,.198)</code>]</li>
</ul>
<p>Answer: P(X <span class="math inline">\(\le\)</span> 2) = 0.266+0.394+0.243=0.903</p>
<p>This can also be done by using the <code>binomial</code> function (which gives “the probability of observing k or fewer successes in n trials when the probability of a success on one trial is p”).</p>
<p>Here, n=6, k=2 and p=0.198, giving the same answer as above: 0.904 (note the discrepancy due to rounding error above). [Command: <code>display binomial(6, 2, 0.198)</code>]</p>
</section>
<section id="r-solution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="r-solution">R Solution</h4>
<p>The computation for binomial probabilities can be done in R using the <code>dbinom</code> and <code>pbinom</code> functions.</p>
<ol type="a">
<li>Of the two binomial functions, we choose the <code>dbinom(x, size, prob)</code> function, which gives the probability of observing <code>x</code> successes in <code>size</code> trials when the probability of a success on one trial is <code>prob</code>.</li>
</ol>
<p>We complete the function using x=6, size=3, and prob=0.198. This gives an answer of 0.08:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08008454</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>In common language, getting “at least 4” smokers means getting 4, 5 or 6 smokers. Since these are mutually exclusive events, we can apply the additive law to find the probability of getting at least 4 smokers:</li>
</ol>
<p><span class="math display">\[ P(X \ge 4) = P(X=4) + P(X=5) + P(X=6) \]</span> Using the same binomial probability function as in the previous question,</p>
<ul>
<li>P(X=4) = 0.015 [Command: <code>dbinom(x=4, size=6, prob=0.198)</code>]</li>
<li>P(X=5) = 0.001 [Command: <code>dbinom(x=5, size=6, prob=0.198)</code>]</li>
<li>P(X=6) = 0.00006 [Command: <code>dbinom(x=6, size=6, prob=0.198)</code>]</li>
</ul>
<p>Answer: <span class="math inline">\(P(X \ge 4) = 0.0148282 + 0.00146437 + 0.00006025 = 0.016\)</span></p>
<p>Alternatively, we can use the <code>pbinom(q, size, prob, lower.tail=FALSE)</code> function (which gives the probability of observing <em>more than <code>q</code></em> successes in <code>size</code> trials when the probability of a success on one trial is <code>prob</code>).</p>
<p>Here, q=3, size=6 and prob=0.198, giving the same answer as above: 0.016:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01635325</code></pre>
</div>
</div>
<ol start="3" type="a">
<li>Observing at most two means observing 0, 1 or 2 smokers. Therefore, the probability of observing at most 2 smokers is:</li>
</ol>
<ul>
<li>P(X <span class="math inline">\(\le\)</span> 2) = P(X=0) + P(X=1) + P(X=2)</li>
<li>P(X=0) = 0.266 [Command: <code>dbinom(x=0, size=6, prob=0.198)</code>]</li>
<li>P(X=1) = 0.394 [Command: <code>dbinom(x=1, size=6, prob=0.198)</code>]</li>
<li>P(X=2) = 0.243 [Command: <code>dbinom(x=2, size=6, prob=0.198)</code>]</li>
</ul>
<p>Answer: <span class="math inline">\(P(X \le 2) = 0.266 + 0.394 + 0.243 = 0.903\)</span></p>
<p>This can also be done by using the <code>pbinom(q, size, prob)</code> function (which gives the probability of observing <em><code>q</code> or fewer</em> successes in <code>size</code> trials when the probability of a success on one trial is <code>prob</code>).</p>
<p>Here, q=2, size=6 and p=0.198, giving the same answer as above: 0.904 (note the discrepancy due to rounding error above).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">2</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9035622</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="normal-distribution" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="normal-distribution"><span class="header-section-number">2.6</span> Normal distribution</h2>
<p>The frequency plot for many biological and clinical measurements (for example blood pressure and height) follow a bell shape where the curve is symmetrical about the mean value and has tails at either end. <a href="#fig-2-1">Figure&nbsp;<span>2.1</span></a> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and <a href="#fig-2-2">Figure&nbsp;<span>2.2</span></a> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> demonstrate this type of distribution.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/mod02/dbp.png" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.1: Distribution of diastolic blood pressure, 2017–18 Australian Bureau of Statistics National Health Survey</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/mod02/heights.png" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.2: Distribution of male and female heights</figcaption>
</figure>
</div>
</div>
</div>
<p>The Normal distribution, also called the Gaussian distribution (named after Johann Carl Friedrich Gauss, 1777–1855), has been shown to fit the frequency distribution of many naturally occurring variables. It is characterised by its bell-shaped, symmetric curve and its tails that approach zero on either side.</p>
<p>There are two reasons for the importance of the Normal distribution in biostatistics (Kirkwood and Sterne, 2003). The first is that many variables can be modelled reasonably well using the Normal distribution. Even if the observed data were not Normally distributed, it can often be made reasonably Normal after applying some transformation of the data. The second (and possible most important) reason, is based on the central limit theorem and will be discussed in Module 3.</p>
<p>The Normal distribution is characterised by two parameters: the mean (<span class="math inline">\(\mu\)</span>) and the standard deviation (<span class="math inline">\(\sigma\)</span>). The mean defines where the middle of the Normal distribution is located, and the standard deviation defines how wide the tails of the distribution are.</p>
<p>For a Normal distribution, about 68% of the observations lie between <span class="math inline">\(- \sigma\)</span> and <span class="math inline">\(\sigma\)</span> of the mean; 95% of the observations lie between <span class="math inline">\(−1.96 \times \sigma\)</span> and <span class="math inline">\(1.96 \times \sigma\)</span> from the mean; and almost all the observations (99.7%) lie between <span class="math inline">\(-3 \times \sigma\)</span> and <span class="math inline">\(3 \times \sigma\)</span> (<a href="#fig-2-3">Figure&nbsp;<span>2.3</span></a>). Also note that the mean is the same as the median, as the curve is symmetric about its mean.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/mod02/normal-curve.png" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.3: Characteristics of a Normal distribution</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-standard-normal-distribution" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="the-standard-normal-distribution"><span class="header-section-number">2.7</span> The Standard Normal distribution</h2>
<p>As each Normal distribution is defined by its mean and standard deviation, there are an infinite number of possible Normal distributions. However, every Normal distribution can be transformed to what we call the Standard Normal distribution, which has a mean of zero (<span class="math inline">\(\mu = 0\)</span>) and a standard deviation of one (<span class="math inline">\(\sigma = 1\)</span>). The Standard Normal distribution is so important that it has been assigned its own symbol: Z.</p>
<p>Every observation from a Normal distribution <span class="math inline">\(X\)</span> with a mean <span class="math inline">\(\mu\)</span> and a standard deviation <span class="math inline">\(\sigma\)</span> can be transformed to a z-score (also called a Standard Normal deviate) by the formula:</p>
<p><span class="math display">\[ z = \frac{x - \mu}{\sigma} \]</span></p>
<p>The z-score is simply how far an observation lies from the population mean value, scaled by the population standard deviation.</p>
<p>We can use z-scores to estimate probabilities, as shown in Worked Example 2.2.</p>
<section id="worked-example-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="worked-example-1">Worked Example</h4>
<p>This example extends the example of diastolic blood pressure shown in <a href="#fig-2-1">Figure&nbsp;<span>2.1</span></a>. Assume that the mean diastolic blood pressure for men is 77.9 mmHg, with a standard deviation of 11. What is the probability that a man selected at random will have high blood pressure (i.e.&nbsp;diastolic blood pressure ≥ 90)?</p>
<p>To estimate the probability that diastolic blood pressure ≥ 90 (i.e.&nbsp;the upper tail probability), we first need to calculate the z-score that corresponds to 90 mmHg.</p>
<p>Using the z-score formula, with x=90, <span class="math inline">\(\mu\)</span>=77.9 and <span class="math inline">\(\sigma\)</span>=11:</p>
<p><span class="math display">\[ z = \frac{90 - 77.9}{11} = 1.1 \]</span> Thus, a blood pressure of 90 mmHg corresponds to a z-score of 1.1, or a value 1.1 <span class="math inline">\(\times \sigma\)</span> above the mean weight of the population.</p>
<p>Using a table of Z-scores (Appendix Table 1), we find the probability that a person has a diastolic blood pressure of 90 mmHg or more as P(Z ≥ 1.1) = 0.136.</p>
<p>An extract from Appendix Table 1 is shown in <a href="#fig-2-4">Figure&nbsp;<span>2.4</span></a> to demonstrate how to find the probability from the look-up table.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/mod02/z-table-extract.png" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.4: Obtaining a probability from a table of Standard Normal distribution</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-2-5">Figure&nbsp;<span>2.5</span></a> shows the probability of a diastolic blood pressure of 90 mmHg or more in the population for a Z-score of greater than 1.1 on a Standard Normal distribution.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/mod02/z-dist-shaded.png" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.5: Area under the Standard Normal curve (as probability) for Z &gt; 1.1</figcaption>
</figure>
</div>
</div>
</div>
<p>Apart from calculating probabilities, Z-scores are most useful for comparing measurements taken from a sample to a known population distribution. It allows measurements to be compared to one another despite being on different scales or having different predicted values.</p>
<p>For example, if we take a sample of children and measure their weights, it is useful to describe those weights as Z-scores from the population weight distribution for each age and gender. Such distributions from large population samples are widely available. This allows us to describe a child’s weight in terms of how much it is above or below the population average. For example, if mean weights were compared, children aged 5 years would be on average heavier than the children aged 3 years simply because they are older and therefore larger. To make a valid comparison, we could use the Z-scores to say that children aged 3 years tend to be more overweight than children aged 5 years because they have a higher mean Z-score for weight.</p>
</section>
</section>
<section id="assessing-normality" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="assessing-normality"><span class="header-section-number">2.8</span> Assessing Normality</h2>
<p>There are several ways to assess whether a continuous variable is Normally distributed. The simple process of plotting a histogram and boxplot and comparing estimates of the centre of the data (mean and median) provide valuable information about the way in which the data are distributed.</p>
<p>Other more formal measures of Normality such as skewness (whether the distribution is symmetrical or asymmetrical) and kurtosis (whether the distribution is flat or peaked) can be obtained from Stata (see Stata Notes section on Producing summary statistics in Module 1).</p>
<section id="skewness-and-kurtosis" class="level3" data-number="2.8.1">
<h3 data-number="2.8.1" class="anchored" data-anchor-id="skewness-and-kurtosis"><span class="header-section-number">2.8.1</span> Skewness and kurtosis</h3>
<p>Skewness is a measure of the lack of symmetry of a distribution. If the distribution is symmetric, the coefficient of skewness is 0. If the coefficient is negative, the median is usually greater than the mean and the distribution is said to be skewed left. If the coefficient is positive, the median is usually less than the mean and the distribution is said to be skewed right.</p>
<p>Kurtosis (from the Greek kyrtosis, meaning curvature) is a measure of peakiness of a distribution. The smaller the coefficient of kurtosis, the flatter the distribution. The Normal distribution has a coefficient of kurtosis of 3 (0 in R) and provides a convenient benchmark. If the distribution is more spread out, then the kurtosis will be greater than 3 (0 in R).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-2-skew" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 95%; margin-left: auto; margin-right: auto;  " id="tab:tbl-2-skew"><caption>Table&nbsp;2.8:  <p>Interpretation of skewness statistics</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Skewness</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Interpretation</th></tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">The distribution is symmetric</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">If skewness is between -0.5 and 0.5, the distribution is approximately symmetric</td></tr>
<tr>
<td rowspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Negative</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Distribution is skewed to the left (mean is usually less than the median) – aka negative skew (longer tail to the left)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">If it is less than −1, the distribution is highly skewed to the left</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">If it is between −1 and −0.5, the distribution is moderately skewed to the left</td></tr>
<tr>
<td rowspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Positive</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Distribution is skewed to the right (mean is usually greater than the median) – aka positive skew (longer tail to the right)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">If it is greater than 1, the distribution is highly skewed to the right</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">If it is between 1 and 0.5, the distribution is moderately skewed to the right</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>For your information: There are formal tests in Stata and R that test for Normality. These tests are beyond the scope of this course and will be discussed in the Advanced course.</p>
<p>The histogram for our 30 weights is approximately bell-shaped and roughly symmetrical. The mean and median (50th percentile) values are identical, as would be expected for a Normal distribution. These statistics indicate that the data are Normally distributed. Finally, you can look at the histogram and boxplot (<a href="#fig-2-6">Figure&nbsp;<span>2.6</span></a>) to assess symmetry and outliers at either end of the distribution.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2-6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/mod02/weights-hist-boxplot.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.6: Histogram and boxplot of weight of 30 students attending a gym</figcaption>
</figure>
</div>
</div>
</div>
<p>A summary of how to explore Normality is shown in <a href="#tbl-2-examine-normality">Table&nbsp;<span>2.9</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-2-examine-normality" class="anchored">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 95%; margin-left: auto; margin-right: auto;  " id="tab:tbl-2-examine-normality"><caption>Table&nbsp;2.9:  <p>Methods to assess Normality</p> </caption>
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Indication of Normality</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Examine histogram</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Approximately bell shaped and symmetrical; may be difficult to determine if the sample size is small</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Compare mean and median values</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Values are approximately equal</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Examine box plot</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Box plot symmetrical with no outliers</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>It is important to look at all these measures together, and not rely on a single measure when assessing whether a sample is approximately Normally distributed. For small samples, it can be very difficult to determine whether the data are approximately Normally distributed.</p>
</section>
</section>
<section id="non-normally-distributed-measurements" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="non-normally-distributed-measurements"><span class="header-section-number">2.9</span> Non-Normally distributed measurements</h2>
<p>In the above example, diastolic blood pressure was Normally distributed with an approximately bell-shaped frequency histogram. However, not all measurements are Normally distributed, and the symmetry of the bell shape may be distorted by the presence of some very small or very large values. Non-Normal distributions such as this are called skewed distributions.</p>
<p>When there are some very large values, the distribution is said to be positively skewed.This often occurs when measuring variables related to time, such as days of hospital stay, where most patients have short stays (say 1 - 5 days) but a few patients with serious medical conditions have very long lengths of hospital stay (say 20 - 100 days).</p>
<p>In practice, most parametric summary statistics are quite robust to minor deviations from Normality and non-parametric statistical methods are only required when the sample size is small and/or the data are obviously skewed with some influential outliers.</p>
<p>When the data are markedly skewed, histograms and boxplots can look very different. For example, data of length of hospital stay in a sample of children are shown as a histogram and as a box plot in <a href="#fig-2-7">Figure&nbsp;<span>2.7</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2-7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/mod02/los-hist-boxplot.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.7: Histogram and boxplot of length of stay</figcaption>
</figure>
</div>
</div>
</div>
<p>In the histogram of <a href="#fig-2-7">Figure&nbsp;<span>2.7</span></a>, there is a tail of values to the right, so we would conclude that the distribution is skewed to the right. In the boxplot, the whiskers appear to be fairly symmetric, but there are some unusual values (denoted by dots) above the box and its whiskers. Stata defines these unusual values as being more than 1.5 times the IQR from the edge of the box.</p>
<p>The presence of unusual values may be an indication that the data are not Normally distributed. Both the histogram and the box plot show that the distribution has a marked tail towards high values and that non-parametric statistics should be used to generate summary statistics and analyse the data.</p>
<p>Note that Stata has defined points as being unusual, or outliers. Outliers can be problematic and the decision to include them or omit them from further analyses can be difficult. After detecting any outliers or extreme values, you should not automatically exclude them from the analysis, particularly if the sample was selected randomly from a population. First, it is important to check the original data collection form or questionnaire to rule out the possibility of a data entry error. If the outlier is not a data entry error, it is then important to decide whether the observation is biologically plausible and, if it is, it should be included in the analysis.</p>
<section id="which-measure-of-central-tendency-to-use" class="level3" data-number="2.9.1">
<h3 data-number="2.9.1" class="anchored" data-anchor-id="which-measure-of-central-tendency-to-use"><span class="header-section-number">2.9.1</span> Which measure of central tendency to use</h3>
<p>It is most appropriate to use the mean when the data exhibit a symmetric or bell-shaped distribution. For skewed distributions (where there are more values on the higher (negative skew) or lower side (positive skew) of the scale) the mean is not a good measure of the centre, as the calculation will be influenced by the extreme values. The median is the preferred statistic for describing central tendency in a skewed distribution.</p>
<p>If the data exhibits a Normal distribution, we use the standard deviation as the measure of spread. Otherwise, the interquartile range is preferred.</p>
</section>
</section>
<section id="parametric-and-non-parametric-statistical-methods" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="parametric-and-non-parametric-statistical-methods"><span class="header-section-number">2.10</span> Parametric and non-parametric statistical methods</h2>
<p>Many statistical methods are based on assumptions about the distribution of the variable – these methods are known as parametric statistical methods. Many methods of statistical inferences based on theoretical sampling properties that are derived from a Normal distribution with the characteristics described above. Thus, it is important that measurements approximate to a Normal distribution before these parametric methods are used. The methods are called ‘parametric’ because they are based on the parameters – the mean and standard deviation - that underlie a Normal distribution. Statistics which do not assume a particular distribution are called distribution-free statistics, or ‘non-parametric statistics’.</p>
<p>In this course, you will learn about both parametric and non-parametric statistical methods. Parametric summary statistical methods include those based on the mean, standard deviation and range (Module 1), and standard error and 95% confidence interval (Module 3). Parametric statistical tests also include t-tests which will be covered in Modules 4 and 5, and correlation and regression described in Module 8.</p>
<p>Non-parametric summary statistical methods are often based on ranks, and may use such statistics as the median, mode and inter-quartile range (Module 1). Non-parametric statistical tests that use ranking are described in Module 9.</p>
</section>
<section id="other-types-of-probability-distributions" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="other-types-of-probability-distributions"><span class="header-section-number">2.11</span> Other types of probability distributions</h2>
<p>In this module we have considered a Normal probability distribution and how to use it to measure the precision of continuously distributed measurements. Data also follow other types of distributions which are briefly described below. In other modules in this course, we will be looking at a range of methods to analyse health data and will refer back to these different distributions.</p>
<p>Normal approximation of binomial: When the sample size becomes large, it becomes cumbersome to calculate the exact probability of an event using the binomial distribution. Conveniently, with large sample sizes, the binomial distribution approximates a Normal distribution. The mean and SD of a binomial distribution can be used to calculate the probability of the event as though it was from a Normal distribution.</p>
<p>Poisson distribution: is another distribution which is often used in health research for modelling count data. The Poisson distribution is followed when a number of events happen in a fixed time interval. This distribution is useful for describing data such as deaths in the population in a time period. For example, the number of deaths from breast cancer in one year in women over 50 years old will be an observation from a Poisson distribution. We can also use this to make comparisons of mortality rates between populations.</p>
<p>Many other probability distributions can be derived for functions which arise in statistical analyses but the chi-squared, t and F distributions are the three distributions that are most widely used. These have many applications, some of which are described in later modules.</p>
<p>The chi-squared distribution is a skewed distribution which allows us to determine the probability of a deviation between a count that we observe and a count that we expect for categorical data. One use of this is in conducting statistical tests for categorical data. See Module 7.</p>
<p>A t-distribution is used when the population standard deviation is not known. The t-distribution is appropriate for small samples (&lt;30) and its distribution is bell shaped similar to a Normal distribution but slightly flatter. The t-distribution is useful for comparing mean values. See Module 4 and Module 5.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="stata-notes" class="level1 unnumbered">
<h1 class="unnumbered">Stata notes</h1>
<section id="importing-data-into-stata" class="level2" data-number="2.12">
<h2 data-number="2.12" class="anchored" data-anchor-id="importing-data-into-stata"><span class="header-section-number">2.12</span> Importing data into Stata</h2>
<p>We have described previously how to open data that have been saved as Stata .dta files. It is quite common to have data saved in other file types, such as Microsoft Excel, or plain text files. In this section, we will demonstrate how to import data from other packages into Stata using commands in the <strong>File &gt; Import</strong> menu.</p>
<section id="importing-plain-text-data-into-stata" class="level3" data-number="2.12.1">
<h3 data-number="2.12.1" class="anchored" data-anchor-id="importing-plain-text-data-into-stata"><span class="header-section-number">2.12.1</span> Importing plain text data into Stata</h3>
<p>A <code>csv</code> file, or a “comma separated variables” file is commonly used to store data. These files have a very simple structure: they are plain text files, where data are separated by commas. csv files have the advantage that, as they are plain text files, they can be opened by a large number of programs (such as Notepad in Windows, TextEdit in MacOS, Microsoft Excel - even Microsoft Word). While they can be opened by Microsoft Excel, they can be opened by many other programs: the csv file can be thought of as the lingua-franca of data.</p>
<p>In this demonstration, we will use data on the weight of 1000 people entered in a csv file called <code>mod02_weight_1000.csv</code> available on Moodle. To confirm that the file is readable by any text editor, here are the first ten lines of the file, opened in Notepad on Microsoft Windows, and TextEdit on MacOS.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/import-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>To import it into Stata, use <strong>File &gt; Import &gt; Text data (delimited, .csv, …)</strong> to bring up the import delimited text data dialog box. Click the <strong>Open</strong> button (the folder icon on the right-hand side of the window) and select the csv file you downloaded. The dialog box should look like below:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/import-02.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>Here, Stata has (correctly) decided that the first row of the dataset contains the variable names. You may need to change this if the Preview window does not look correct. Click <strong>OK</strong> or <strong>Submit</strong> button to import the data.</p>
</section>
</section>
<section id="checking-your-data-for-errors-in-stata" class="level2" data-number="2.13">
<h2 data-number="2.13" class="anchored" data-anchor-id="checking-your-data-for-errors-in-stata"><span class="header-section-number">2.13</span> Checking your data for errors in Stata</h2>
<p>Before you start describing and analysing your data, it is important to make sure that no errors have been made during the data entry process. Basically, you are looking for values that are outside the range of possible or plausible values for that variable.</p>
<p>If an error is found, the best method for correcting the error is to go back to the original data e.g.&nbsp;the hard copy questionnaire, to obtain the original value, entering the correct value into Stata. If the original data is not available or the original data is also incorrect, the erroneous value is often excluded from the dataset.</p>
<p>For continuous variables, the easiest methods are to examine a boxplot and histogram. For example, a boxplot and histogram for the weight variable we just imported appear as:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/check-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>There is a clear outlying point shown in the boxplot. Although not obvious, the same point is shown in the histogram as a bar around 700 with a very short height.</p>
<p>To identify the outlying observation in the dataset, we can sort your data in ascending order and check the minimum and maximum values in the Data Editor. You will need to decide if these values are a data entry error or are biologically plausible. If an extreme value or “outlier”, is biologically plausible, it should be included in all analyses.</p>
<p>To sort data, you must be in the <strong>Data Editor (Edit)</strong> window. Select <strong>Data &gt; Sort data…</strong> and choose <code>weight</code> as shown in the <strong>sort</strong> dialog box below. Click <strong>OK</strong> to do an <em>ascending</em> sort (arranging weight from smallest to largest). [Command: <code>sort weight</code>]</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/check-02.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>By scrolling through the data, you will see that the values range from 53.8kg to 85.8kg with a very high value of 700.2kg. A value as high as 700kg is likely to be a data entry error (e.g.&nbsp;error in entering an extra zero) and is not a plausible weight value. Here, <strong>you should check your original data</strong>. You might find that the original weight was recorded as 70.2kg. You can change this in Stata by deleting a zero from cell with 700.2 in the <strong>Data Editor (Edit)</strong> window.</p>
<p><strong>Note:</strong> if an extreme value lies within the range of biological plausibility it should not be removed from analysis.</p>
<p>Once you have checked your data for errors, you are ready to start analysing your data.</p>
</section>
<section id="overlaying-a-normal-curve-on-a-histogram" class="level2" data-number="2.14">
<h2 data-number="2.14" class="anchored" data-anchor-id="overlaying-a-normal-curve-on-a-histogram"><span class="header-section-number">2.14</span> Overlaying a Normal curve on a Histogram</h2>
<p>It can be useful to produce a histogram with an overlayed Normal curve to assess whether our sample appears approximately Normally distributed. First go to menu <strong>Graphics &gt; Histogram</strong>. In the <strong>Histogram</strong> dialog box, select <code>weight</code> into the <strong>variable</strong> box and choose the <strong>Frequency</strong> radio button for ease of interpretation.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/hist-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>You can click the <strong>Submit</strong> button to check how the plot looks like. To superimpose the normal curve, go to the <strong>Density plots</strong> and tick <strong>Add normal-density plot</strong>, then click the <strong>Submit</strong> or <strong>OK</strong> button. You can change the X-axis label in the <strong>X axis</strong> tab, e.g.&nbsp;to <code>Weight (kg)</code>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/hist-02.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>[Command: <code>histogram weight, frequency normal xtitle(Weight (kg))</code>]</p>
<p>Your histogram should look like this:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/hist-03.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
</section>
<section id="descriptive-statistics-for-checking-normality" class="level2" data-number="2.15">
<h2 data-number="2.15" class="anchored" data-anchor-id="descriptive-statistics-for-checking-normality"><span class="header-section-number">2.15</span> Descriptive statistics for checking normality</h2>
<p>All the descriptive statistics including Skewness and Kurtosis discussed in this module can be obtained using the <code>summarize</code> command from <strong>Statistics &gt; Summaries, tables, and tests &gt; Summary and descriptive statistics &gt; Summary statistics</strong> and specifying <strong>detail</strong> as an option in Stata (as shown in the Stata Notes for Module 1).</p>
<p>[Command: <code>summarize weight, detail</code>]</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/desc-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>You can similarly repeat this using the dataset <code>mod02_weight_30.dta</code> used for creating these in the course notes for this module.</p>
</section>
<section id="importing-excel-data-into-stata" class="level2" data-number="2.16">
<h2 data-number="2.16" class="anchored" data-anchor-id="importing-excel-data-into-stata"><span class="header-section-number">2.16</span> Importing Excel data into Stata</h2>
<p>Another common type of file that data are stored in is a Microsoft Excel file (.xls or .xlsx). In this demonstration, we will import a selection of records from a large health survey, stored in the file <code>mod02_health_survey.xlsx</code>.</p>
<p>The health survey data contains 1140 records, comprising:</p>
<ul>
<li>sex: 1 = respondent identifies as male; 2 = respondent identifies as female</li>
<li>height: height in meters</li>
<li>weight: weight in kilograms</li>
</ul>
<p>To import data from Microsoft Excel, we use <strong>File &gt; Import &gt; Excel spreadsheet</strong>. First click <strong>Browse</strong> to locate the file to be imported:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/import-excel-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>Take special note of the <strong>Preview</strong> at the bottom of the dialog box. Our dataset has the variable names listed in the first row of the spreadsheet, so we tick the <strong>Import first row as variable names</strong> checkbox. We don’t want to <strong>Import all data as strings</strong> (strings are character, or text variables), so we leave this unchecked. We finalise the process by clicking <strong>OK</strong>.</p>
<p>As always, check the Data Browser to confirm that the data were imported successfully.</p>
</section>
<section id="generating-new-variables" class="level2" data-number="2.17">
<h2 data-number="2.17" class="anchored" data-anchor-id="generating-new-variables"><span class="header-section-number">2.17</span> Generating new variables</h2>
<p>Our health survey data contains information on height and weight. We often summarise body size using BMI: body mass index which is calculated as: <span class="math inline">\(\frac{\text{weight (kg)}}{(\text{height (m)})^2}\)</span></p>
<p>To generate a new variable, we use <strong>Data &gt; Create or change data &gt; Create new variable</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/gen-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<ol type="1">
<li>type the name of the new variable, BMI, in the Variable name box.</li>
<li>enter the formula to calculate the variable in “Specify a value or an expression”. This can be done in one of two ways:</li>
</ol>
<p><strong>Option 1:</strong> click <strong>Create</strong> to open the Expression Builder dialog box. This box allows you to build the formula interactively:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/gen-02.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>Clicking <strong>Variables</strong> in the lower-left-hand pane shows a list of variables in the lower-middle pane of the window. We want to create a new formula of <span class="math inline">\(\text{weight } \div \text{ height} ^2\)</span>. Double-clicking a variable name moves that variable into the formula builder. To build our BMI formula:</p>
<ol type="i">
<li>double-click <code>weight</code></li>
<li>click the <strong>/</strong> button (to represent <span class="math inline">\(\div\)</span>). Note that you can type the <strong>/</strong> symbol instead of clicking the button</li>
<li>double-click <code>height</code></li>
<li>click the <strong>^</strong> button (to represent “to the power of”) - again you can type the <strong>^</strong> symbol</li>
<li>enter <code>2</code> (as ^2 represents “to the power of 2”, or “squared”</li>
</ol>
<p>Your completed window should look like:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/gen-03.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>Click <strong>OK</strong> to return to the generate dialog box, which now should appear as:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/gen-04.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p><strong>Option 2:</strong> if you are entering a simple formula, you can type the formula directly into the expression using your keyboard.</p>
<p>Click <strong>OK</strong> to generate your new variable.</p>
<p>[Command: <code>generate BMI = weight / height ^ 2</code>]</p>
<p>We should check the construction of the new variable by examining the Data Browser:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/gen-05.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>In the general population, BMI ranges between about 15 to 30. It appears that BMI has been correctly generated in this example.</p>
</section>
<section id="summarising-data-by-another-variable" class="level2" data-number="2.18">
<h2 data-number="2.18" class="anchored" data-anchor-id="summarising-data-by-another-variable"><span class="header-section-number">2.18</span> Summarising data by another variable</h2>
<p>We will often want to calculate the same summary statistics by another variable. For example, we might want to calculate summary statistics for BMI for males and females separately. We can do this in Stata by defining sex as a <em>by-variable</em>. Many Stata commands (and dialog boxes) allow for a by-variable. For example, to obtain summary statistics for BMI by sex (note that sex has been given a value label, as described in Module 1):</p>
<ol type="1">
<li>Define <code>BMI</code> as our <strong>Variable</strong> in the <strong>Statistics &gt; Summaries, tables, and tests &gt; Summary and descriptive statistics &gt; Summary statistics</strong> dialog box.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/summ-by-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<ol start="2" type="1">
<li>Click the <strong>by/if/in</strong> tab, tick <strong>Repeat command by groups</strong>, and select the variable you want to be the <em>by-variable</em>. In this case, we choose <code>sex</code> and then click <strong>OK</strong>.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/summ-by-02.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>[Command: <code>by sex, sort : summarize BMI</code>]</p>
<p>The by-variable will tell Stata to repeat the <code>summarize</code> command for each distinct value of <code>sex</code>. Hence, your by-variable must be a discrete variable with only a relatively small number of categories.</p>
<p>The following results appear:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>. by sex, sort <span class="sc">:</span> summarize BMI</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------------</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ot">-&gt;</span> sex <span class="ot">=</span> Male</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    Variable <span class="sc">|</span>        Obs        Mean    Std. Dev.       Min        Max</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+---------------------------------------------------------</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>         BMI <span class="sc">|</span>        <span class="dv">513</span>    <span class="fl">28.29561</span>    <span class="fl">5.204975</span>   <span class="fl">16.47519</span>   <span class="fl">57.23643</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------------</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="ot">-&gt;</span> sex <span class="ot">=</span> Female</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    Variable <span class="sc">|</span>        Obs        Mean    Std. Dev.       Min        Max</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+---------------------------------------------------------</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>         BMI <span class="sc">|</span>        <span class="dv">627</span>    <span class="fl">27.81434</span>    <span class="fl">6.380523</span>   <span class="fl">9.209298</span>   <span class="fl">52.59515</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we have calculated summary statistics separately for Males and Females. A form of the <strong>by</strong> tab appears in many Stata windows. For example, we can create separate histograms for males and females using the same two-step process:</p>
<ol type="1">
<li>Define <code>BMI</code> as the variable to be plotted</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/hist-by-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<ol start="2" type="1">
<li>Define <code>sex</code> as a <em>by-variable</em> by completing the <strong>By</strong> tab:</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/hist-by-02.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>This produces the following graph:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/hist-by-03.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
</section>
<section id="recoding-data" class="level2" data-number="2.19">
<h2 data-number="2.19" class="anchored" data-anchor-id="recoding-data"><span class="header-section-number">2.19</span> Recoding data</h2>
<p>One task that is common in statistical computing is to recode variables. For example, we might want to group some categories of a categorical variable, or to present a continuous variable in a categorical way.</p>
<p>In this example, we can recode BMI into the following categories as suggested by the World Health Organisation [footnote]:</p>
<ul>
<li>Underweight: BMI &lt; 18.5</li>
<li>Normal weight: 18.5 <span class="math inline">\(\le\)</span> BMI &lt; 25</li>
<li>Pre-obesity: 25 <span class="math inline">\(\le\)</span> BMI &lt; 30</li>
<li>Obesity Class I: 30 <span class="math inline">\(\le\)</span> BMI &lt; 35</li>
<li>Obesity Class II: 35 <span class="math inline">\(\le\)</span> BMI &lt; 40</li>
<li>Obesity Class III: BMI <span class="math inline">\(\ge\)</span> 40</li>
</ul>
<p>To recode data in Stata, we use the <strong>Recode categorical variable</strong> command. It may seem odd to use a command called <strong>Recode categorical variable</strong> to recode BMI, a continuous variable, but that is just the name Stata uses for its recode command.</p>
<ol type="1">
<li>Click <strong>Data &gt; Create or change data &gt; Other variable-transformation commands &gt; Recode categorical variable</strong> to open the <strong>recode</strong> dialog box.</li>
<li>Choose <code>BMI</code> as the variable to be recoded from.</li>
<li>Enter the recoding rules. To recode from a range of values to a new category while assigning a value label, we enter the recoding rule in the following form:</li>
</ol>
<p>(<em>a</em> / <em>b</em> = <em>c</em> “label”) where:</p>
<ul>
<li><em>a</em> is the lower limit of the range to be recoded from</li>
<li><em>b</em> is the upper limit of the range to be recoded from</li>
<li><em>c</em> is the value of the new category to be recoded to</li>
<li><em>label</em> is the label to assign to the category <em>c</em></li>
</ul>
<p>It is important to note that the values of <em>a</em> and <em>b</em> are inclusive; and we can use the words <code>min</code> and <code>max</code> to represent the smallest and largest values respectively.</p>
<p>So to recode the underweight category, we would enter: <code>(min / 18.4999 = 1 "Underweight")</code> Similarly, for the normal weight category, we would enter: <code>(18.5 / 24.9999 = 2 "Normal weight")</code></p>
<p>Your completed recode dialog box should look as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/mod02/stata/recode-01.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="1">
<li><strong>Do not forget this step!</strong> To recode into a new variable, we <strong>must</strong> click the options tab to give the name of the new variable. If this step is not performed, Stata will overwrite the initial variable with the recoded version. Here, we tell Stata to generate a new variable called bmi_category:</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/mod02/stata/recode-02.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Click <strong>OK</strong> to complete the recoding.</p>
<p>Note that the default label for the new recoded variable <code>bmi_category</code> is <code>RECODE of BMI</code>. This can be relabelled in the usual way: click on <code>bmi_category</code> in the <strong>Variables</strong> window, then enter a name such as <code>BMI Category</code> in the <strong>Label</strong> box in the <strong>Properties</strong> window.</p>
</section>
<section id="computing-binomial-probabilities-using-the-hand-calculator-in-stata" class="level2" data-number="2.20">
<h2 data-number="2.20" class="anchored" data-anchor-id="computing-binomial-probabilities-using-the-hand-calculator-in-stata"><span class="header-section-number">2.20</span> Computing binomial probabilities using the Hand calculator in Stata</h2>
<p>There are three Stata functions that we can use to calculate probabilities based on the binomial distribution: <code>binomialp</code>, <code>binomial</code> and <code>binomialtail</code>. Stata provides a description of the function in the <strong>Expression Builder</strong>, summarised below.</p>
<div class="cell">
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 95%; margin-left: auto; margin-right: auto;  " id="tab:binfuns">
<caption style="caption-side: top; text-align: center;">Summary of Stata's binomial functions</caption><colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Function</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Description</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Example</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">binomialp(n,k,p)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">The probability of observing k successes in n trials when the probability of a success on one trial is p</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Probability of observing 3 smokers from 6 people</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">binomial(n,k,p)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">The probability of observing k or fewer successes in n trials when the probability of a success on one trial is p</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Probability of observing 2 or fewer smokers from 6 people</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">binomialtail(n,k,p)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">The probability of observing k or more successes in n trials when the probability of a success on one trial is p</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Probability of observing 4 or more smokers from 6 people</td></tr>
</tbody></table>

</div>
</div>
<p>To do the computation for part (a) in Worked Example 2.1, go to <strong>Data &gt; Other utilities &gt; Hand calculator</strong> from the main menu in Stata.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/binomial-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>In the dialog box, click <strong>Create…</strong> to bring up the <strong>Expression Builder</strong> dialog box. In the <strong>Categories</strong> box, click on <strong>Functions</strong> to expand the list, then scroll down to <strong>Statistical</strong>, expand the list again and select <strong>Binomial</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/binomial-02.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>A list of functions will pop up to the right of the <strong>Categories</strong> box. Double click on <strong>binomialp()</strong> which will populate the top of the expression builder box with <code>binomialp(n,k,p)</code>. Following the instructions at the bottom of the box:</p>
<ul>
<li><em>k</em> is the number of successes, here, the number of smokers (i.e.&nbsp;k=3);</li>
<li><em>n</em> is the number of trials (i.e.&nbsp;n=6);</li>
<li>and <em>p</em> is probability of drawing a smoker from the population, which is 19.8% (i.e.&nbsp;p=0.198).</li>
</ul>
<p>Replace each of these with the appropriate number into the box as shown below.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/binomial-03.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>Click the <strong>OK</strong> button in the Expression Builder box, then click <strong>OK</strong> or <strong>Submit</strong> in the main dialog box. The probability is now displayed on your Results screen as <code>.08008454</code> which rounds off to 0.08 as shown in part (a) of Worked Example 2.1. (Note that Stata doesn’t print the 0 in front of the decimal point in the output.)</p>
<p>[Command: <code>display binomialp(6, 3, 0.198)</code>]</p>
<p>To calculate the upper tail of probability in part (b), go to <strong>Data &gt; Other utilities &gt; Hand calculator</strong> from the main menu and bring up the <strong>Expression Builder</strong> box again. You may need to clear the text in your Expression box from your previous display command.</p>
<p>In the <strong>Categories</strong> box, navigate to <strong>Binomial</strong> and select it as you had before. Now double click on <strong>binomialtail()</strong> which will populate the top of the expression builder box with <code>binomialtail(n,k,p)</code>. To obtain P(X <span class="math inline">\(\ge\)</span> 4) from 6 trials, <em>n</em>=6, <em>k</em>=4 and <em>p</em>=0.198. When you are done, click the <strong>OK</strong> button in the <strong>Expression Builder</strong> box to get the below in the display dialog box:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/binomial-04.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>Click <strong>OK</strong> or <strong>Submit</strong> when you are done. [Command: <code>display binomialtail(6, 4, 0.198)</code>]</p>
<p>For the lower tail for part (c), choose or double-click on <strong>binomial()</strong> from the list of functions. To obtain P(X <span class="math inline">\(\le\)</span> 2) from 6 trials, enter <em>n</em>=6, <em>k</em>=2 and <em>p</em>=0.198.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/binomial-05.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>Click <strong>OK</strong> or <strong>Submit</strong> when you are done. [Command: <code>display binomial(6, 2, 0.198)</code>]</p>
</section>
<section id="computing-probabilities-from-the-normal-distribution-using-the-hand-calculator-in-stata" class="level2" data-number="2.21">
<h2 data-number="2.21" class="anchored" data-anchor-id="computing-probabilities-from-the-normal-distribution-using-the-hand-calculator-in-stata"><span class="header-section-number">2.21</span> Computing probabilities from the normal distribution using the Hand calculator in Stata</h2>
<p>From Stata, the probability using a normal distribution can be obtained from the display command via <strong>Data &gt; Other utilities &gt; Hand calculator</strong> as shown in Worked example 2.1. In the dialog box, click the <strong>Create…</strong> button to bring up the <strong>Expression Builder</strong> dialog box. In the <strong>Categories</strong> box, click on <strong>Functions</strong> to expand the list, then scroll down to <strong>Statistical</strong> and expand the list again and select <strong>Normal</strong> this time. Double-click on <strong>normal()</strong> to populate the top of the expression builder box with <code>normal(z)</code>.</p>
<p>The instructions at the bottom of the box explain that this is the cumulative standard normal distribution which means it gives P(Z&lt;z) in Stata. In other words, the normal() function gives you the <strong>lower tail</strong> probability from the standard normal distribution. To obtain P(Z&gt;0.5), edit the box to <code>1-normal(0.5)</code> as shown below.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/stata/normal-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>Click <strong>OK</strong>, then <strong>Submit</strong> to obtain the same value as from the table. [Command: <code>display 1-normal(0.5)</code>]</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="r-notes" class="level1 unnumbered">
<h1 class="unnumbered">R notes</h1>
<section id="importing-data-into-r" class="level2" data-number="2.22">
<h2 data-number="2.22" class="anchored" data-anchor-id="importing-data-into-r"><span class="header-section-number">2.22</span> Importing data into R</h2>
<p>We have described previously how to import data that have been saved as R .rds files. It is quite common to have data saved in other file types, such as Microsoft Excel, or plain text files. In this section, we will demonstrate how to import data from other packages into R.</p>
<p>There are two useful packages for importing data into R: <code>haven</code> (for data that have been saved by Stata, SAS or SPSS) and <code>readxl</code> (for data saved by Microsoft Excel). Additionally, the <code>labelled</code> package is useful in working with data that have been labelled in Stata.</p>
<section id="importing-plain-text-data-into-r" class="level3" data-number="2.22.1">
<h3 data-number="2.22.1" class="anchored" data-anchor-id="importing-plain-text-data-into-r"><span class="header-section-number">2.22.1</span> Importing plain text data into R</h3>
<p>A <code>csv</code> file, or a “comma separated variables” file is commonly used to store data. These files have a very simple structure: they are plain text files, where data are separated by commas. csv files have the advantage that, as they are plain text files, they can be opened by a large number of programs (such as Notepad in Windows, TextEdit in MacOS, Microsoft Excel - even Microsoft Word). While they can be opened by Microsoft Excel, they can be opened by many other programs: the csv file can be thought of as the lingua-franca of data.</p>
<p>In this demonstration, we will use data on the weight of 1000 people entered in a csv file called <code>mod02_weight_1000.csv</code> available on Moodle.</p>
<p>To confirm that the file is readable by any text editor, here are the first ten lines of the file, opened in Notepad on Microsoft Windows, and TextEdit on MacOS.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod02/import-01.png" class="img-fluid" style="width:66.0%"></p>
</div>
</div>
<p>We can use the <code>read.csv</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/examples/mod02_weight_1000.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, the <code>read.csv</code> function has the default that the first row of the dataset contains the variable names. If your data do not have column names, you can use <code>header=FALSE</code> in the function.</p>
<p>Note: there is an alternative function <code>read_csv</code> which is part of the <code>readr</code> package (a component of the <code>tidyverse</code>). Some would argue that the <code>read_csv</code> function is more appropriate to use because of an issue known as <code>strings.as.factors</code>. The <code>strings.as.factors</code> default was removed in R Version 4.0.0, so it is less important which of the two functions you use to import a <code>.csv</code> file. More information about this issue can be found <a href="https://simplystatistics.org/posts/2015-07-24-stringsasfactors-an-unauthorized-biography">here</a> and <a href="https://developer.r-project.org/Blog/public/2020/02/16/stringsasfactors/">here</a>.</p>
</section>
</section>
<section id="checking-your-data-for-errors-in-r" class="level2" data-number="2.23">
<h2 data-number="2.23" class="anchored" data-anchor-id="checking-your-data-for-errors-in-r"><span class="header-section-number">2.23</span> Checking your data for errors in R</h2>
<p>Before you start describing and analysing your data, it is important to make sure that no errors have been made during the data entry process. Basically, you are looking for values that are outside the range of possible or plausible values for that variable.</p>
<p>If an error is found, the best method for correcting the error is to go back to the original data e.g.&nbsp;the hard copy questionnaire, to obtain the original value, entering the correct value into R If the original data is not available or the original data is also incorrect, the erroneous value is often excluded from the dataset.</p>
<p>For continuous variables, the easiest methods are to examine a boxplot and histogram. For example, a boxplot and histogram for the weight variable we just imported appear as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample<span class="sc">$</span>weight, <span class="at">xlab=</span><span class="st">"Weight (kg)"</span>, <span class="at">main=</span><span class="st">"Histogram of 1000 weights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-probability_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(sample<span class="sc">$</span>weight, <span class="at">xlab=</span><span class="st">"Weight (kg)"</span>, <span class="at">main=</span><span class="st">"Boxplot of 1000 weights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-probability_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There is a clear outlying point shown in the boxplot. Although not obvious, the same point is shown in the histogram as a bar around 700 with a very short height.</p>
<p>We can identify any outlying observations in the dataset using the <code>subset</code> function. You will need to decide if these values are a data entry error or are biologically plausible. If an extreme value or “outlier”, is biologically plausible, it should be included in all analyses.</p>
<p>For example, to list any observations from the <code>sample</code> dataset with a weight larger than 200:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(sample, weight<span class="sc">&gt;</span><span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">id</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">weight</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">58</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">700</td></tr>
</tbody></table>

</div>
</div>
<p>We see that there is a very high value of 700.2kg. A value as high as 700kg is likely to be a data entry error (e.g.&nbsp;error in entering an extra zero) and is not a plausible weight value. Here, <strong>you should check your original data</strong>.</p>
<p>You might find that the original weight was recorded in medical records as 70.2kg. You can change this in R by writing code.</p>
<p><strong>Note:</strong> many statistical packages will allow you to view a spreadsheet version of your data and edit values in that spreadsheet. This is not best practice, as corrected observations may revert to their original values depending on whether the edited data have been saved or not. By using code-based recoding, the changes will be reproduced the next time the code is run.</p>
<p>We will use an <code>ifelse</code> statement to recode the incorrect weight of 700.2kg into 70.2kg. The form of the <code>ifelse</code> statement is as follows:</p>
<p><code>ifelse(test, value_if_true, value_if_false)</code></p>
<p>Our code will create a new column (called <code>weight_clean</code>) in the <code>sample</code> dataframe. We will test whether <code>weight</code> is equal to 700.2; if this is true, we will assign <code>weight_clean</code> to be 70.2, otherwise <code>weight_clean</code> will equal the value of <code>weight</code>.</p>
<p>Putting it all together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sample<span class="sc">$</span>weight_clean <span class="ot">=</span> <span class="fu">ifelse</span>(sample<span class="sc">$</span>weight<span class="sc">==</span><span class="fl">700.2</span>, <span class="fl">70.2</span>, sample<span class="sc">$</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Note:</strong> if an extreme value lies within the range of biological plausibility it should not be removed from analysis.</p>
<p>Once you have checked your data for errors, you are ready to start analysing your data.</p>
<section id="what-on-earth" class="level3" data-number="2.23.1">
<h3 data-number="2.23.1" class="anchored" data-anchor-id="what-on-earth"><span class="header-section-number">2.23.1</span> What on earth: == ?</h3>
<p>In R, the test of equality is denoted by two equal signs: <code>==</code>. So we would use <code>==</code> to test whether an observation is equal to a certain value. Let’s see an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test whether 6 is equal to 6</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="sc">==</span> <span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test whether 6 is equal to 42</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="sc">==</span> <span class="dv">42</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>You can read the <code>==</code> as “is equal to”. So the code <code>sample$weight == 700.2</code> is read as: “is the value of weight from the data frame sample equal to 700.2?”. In our <code>ifelse</code> statement above, if this condition is true, we replace <code>weight</code> by 70.2; if it is false, we leave weight as is.</p>
</section>
</section>
<section id="overlaying-a-normal-curve-on-a-histogram-1" class="level2" data-number="2.24">
<h2 data-number="2.24" class="anchored" data-anchor-id="overlaying-a-normal-curve-on-a-histogram-1"><span class="header-section-number">2.24</span> Overlaying a Normal curve on a histogram</h2>
<p>It can be useful to produce a histogram with an overlayed Normal curve to assess whether our sample appears approximately Normally distributed. We can do this by plotting a histogram using the <code>hist()</code> function. As we’re overlaying a probability distribution, we request the histogram be plotted on a probability scale, rather than a frequency scale, using <code>probability=TRUE</code>.</p>
<p>We then request a curve be overlayed using the <code>curve()</code> function:</p>
<ul>
<li><p>the curve should be based on the Normal distribution (<code>dnorm</code>);</p>
<ul>
<li><p>with a mean equal to the mean of the cleaned weight: <code>mean(sample$weight_clean));</code></p></li>
<li><p>and a standard deviation equal to the standard deviation of the cleaned weight: <code>sd(sample$weight_clean))</code></p></li>
</ul></li>
<li><p>using a dark-blue colour;</p></li>
<li><p>and added to the previous histogram (rather than plotting the curve by itself): <code>add=TRUE</code></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample<span class="sc">$</span>weight_clean,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Weight (kg)"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Histogram of 1000 weights"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean=</span><span class="fu">mean</span>(sample<span class="sc">$</span>weight_clean),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd=</span><span class="fu">sd</span>(sample<span class="sc">$</span>weight_clean)),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="st">"darkblue"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-probability_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that the top of the curve is chopped off. We can plot the whole curve by extending the y-axis of the histogram to 0.1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample<span class="sc">$</span>weight_clean, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Weight (kg)"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Histogram of 1000 weights"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean=</span><span class="fu">mean</span>(sample<span class="sc">$</span>weight_clean),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd=</span><span class="fu">sd</span>(sample<span class="sc">$</span>weight_clean)),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="st">"darkblue"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-probability_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="descriptive-statistics-for-checking-normality-1" class="level2" data-number="2.25">
<h2 data-number="2.25" class="anchored" data-anchor-id="descriptive-statistics-for-checking-normality-1"><span class="header-section-number">2.25</span> Descriptive statistics for checking normality</h2>
<p>All the descriptive statistics including <em>skewness</em> and <em>kurtosis</em> discussed in this module can be obtained using the <code>descriptives</code> function from the <code>jmv</code> package. In particular, skewness and kurtosis can be requested in addition to the default statistics by including: <code>skew=TRUE, kurt=TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jmv)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>sample, <span class="at">vars=</span>weight_clean, <span class="at">skew=</span><span class="cn">TRUE</span>, <span class="at">kurt=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 DESCRIPTIVES

 Descriptives                            
 ─────────────────────────────────────── 
                          weight_clean   
 ─────────────────────────────────────── 
   N                              1000   
   Missing                           0   
   Mean                       69.76450   
   Median                     69.80000   
   Standard deviation         5.052676   
   Minimum                    53.80000   
   Maximum                    85.80000   
   Skewness                 0.07360659   
   Std. error skewness      0.07734382   
   Kurtosis                 0.05418774   
   Std. error kurtosis       0.1545343   
 ─────────────────────────────────────── </code></pre>
</div>
</div>
</section>
<section id="importing-excel-data-into-r" class="level2" data-number="2.26">
<h2 data-number="2.26" class="anchored" data-anchor-id="importing-excel-data-into-r"><span class="header-section-number">2.26</span> Importing Excel data into R</h2>
<p>Another common type of file that data are stored in is a Microsoft Excel file (.xls or .xlsx). In this demonstration, we will import a selection of records from a large health survey, stored in the file <code>mod02_health_survey.xlsx</code>.</p>
<p>The health survey data contains 1140 records, comprising:</p>
<ul>
<li>sex: 1 = respondent identifies as male; 2 = respondent identifies as female</li>
<li>height: height in meters</li>
<li>weight: weight in kilograms</li>
</ul>
<p>To import data from Microsoft Excel, we can use the <code>read_excel()</code> function in the <code>readxl</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>survey <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/examples/mod02_health_survey.xlsx"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      sex           height          weight      
 Min.   :1.00   Min.   :1.220   Min.   : 22.70  
 1st Qu.:1.00   1st Qu.:1.630   1st Qu.: 68.00  
 Median :2.00   Median :1.700   Median : 79.40  
 Mean   :1.55   Mean   :1.698   Mean   : 81.19  
 3rd Qu.:2.00   3rd Qu.:1.780   3rd Qu.: 90.70  
 Max.   :2.00   Max.   :2.010   Max.   :213.20  </code></pre>
</div>
</div>
<p>We can see that sex has been entered as a numeric variable. We should transform it into a factor so that we can assign labels to each category:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(survey<span class="sc">$</span>sex, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Male Female 
   513    627 </code></pre>
</div>
</div>
<p>We also note that height looks like it has been entered as meters, and weight as kilograms.</p>
</section>
<section id="generating-new-variables-1" class="level2" data-number="2.27">
<h2 data-number="2.27" class="anchored" data-anchor-id="generating-new-variables-1"><span class="header-section-number">2.27</span> Generating new variables</h2>
<p>Our health survey data contains information on height and weight. We often summarise body size using BMI: body mass index which is calculated as: <span class="math inline">\(\frac{\text{weight (kg)}}{(\text{height (m)})^2}\)</span></p>
<p>We can create a new column in our data frame in many ways, such as using the following approach:</p>
<p><code>dataframe$new_column &lt;- &lt;formula&gt;</code></p>
<p>For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>bmi <span class="ot">&lt;-</span> survey<span class="sc">$</span>weight <span class="sc">/</span> (survey<span class="sc">$</span>height<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We should check the construction of the new variable by examining some records. The <code>head()</code> and <code>tail()</code> functions list the first and last 6 records in any dataset. We can also examine a histogram and boxplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(survey)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sex</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">height</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">weight</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">bmi</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.63</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">81.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">30.8</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.63</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">68&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">25.6</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.85</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">97.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">28.4</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.78</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">89.8</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">28.3</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.73</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">70.3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">23.5</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.57</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">85.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">34.8</td></tr>
</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(survey)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sex</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">height</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">weight</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">bmi</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.65</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">95.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">35.2</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">79.4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">24.5</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.73</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">83&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">27.7</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.57</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">61.2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">24.8</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.7&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">73&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">25.3</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.55</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">91.2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">38&nbsp;&nbsp;</td></tr>
</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(survey<span class="sc">$</span>bmi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-probability_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(survey<span class="sc">$</span>bmi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-probability_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the general population, BMI ranges between about 15 to 30. It appears that BMI has been correctly generated in this example. We should investigate the very low and some of the very high values of BMI, but this will be left for another time.</p>
</section>
<section id="summarising-data-by-another-variable-1" class="level2" data-number="2.28">
<h2 data-number="2.28" class="anchored" data-anchor-id="summarising-data-by-another-variable-1"><span class="header-section-number">2.28</span> Summarising data by another variable</h2>
<p>We will often want to calculate the same summary statistics by another variable. For example, we might want to calculate summary statistics for BMI for males and females separately. We can do this in in the <code>descriptives</code> function by defining sex as a <code>splitBy</code> variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jmv)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>survey, <span class="at">vars=</span>bmi, <span class="at">splitBy =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 DESCRIPTIVES

 Descriptives                                 
 ──────────────────────────────────────────── 
                         sex       bmi        
 ──────────────────────────────────────────── 
   N                     Male           513   
                         Female         627   
   Missing               Male             0   
                         Female           0   
   Mean                  Male      28.29561   
                         Female    27.81434   
   Median                Male      27.39592   
                         Female    26.66667   
   Standard deviation    Male      5.204975   
                         Female    6.380523   
   Minimum               Male      16.47519   
                         Female    9.209299   
   Maximum               Male      57.23644   
                         Female    52.59516   
 ──────────────────────────────────────────── </code></pre>
</div>
</div>
</section>
<section id="summarising-a-single-column-of-data" class="level2" data-number="2.29">
<h2 data-number="2.29" class="anchored" data-anchor-id="summarising-a-single-column-of-data"><span class="header-section-number">2.29</span> Summarising a single column of data</h2>
<p>In Module 1, we started with a very simple analysis: reading in six ages, and them using <code>summary()</code> to calculate descriptive statistics. We then went on to use the <code>decriptives()</code> function in the <code>jmv</code> package as more flexible way of calculating descriptive statistics. Let’s revisit this analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: Timothy Dobbins</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Date: 5 April 2022</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Purpose: My first R script</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jmv)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">21</span>, <span class="dv">27</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use "summary" to obtain descriptive statistics</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  20.00   21.50   24.00   24.17   26.50   29.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the "descriptives" function from jmv to obtain descriptive statistics</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: Argument 'data' must be a data frame</code></pre>
</div>
</div>
<p>The <code>summary()</code> function has worked correctly, but the <code>descriptives()</code> function has given an error: <code>Error: Argument 'data' must be a data frame</code>. What on earth is going on here?</p>
<p>The error gives us a clue here - the <code>descriptives()</code> function requires a data frame for analysis. We have provided the object <code>age</code>: a <strong>vector</strong>. As we saw in <span class="quarto-unresolved-ref">?sec-data-structures</span>, a vector is a single column of data, while a data frame is a collection of columns.</p>
<p>In order to summarise a vector using the <code>descriptives()</code> function, we must first convert the vector into a data frame using <code>as.data.frame()</code>. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: Timothy Dobbins</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Date: 5 April 2022</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Purpose: My first R script</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jmv)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">21</span>, <span class="dv">27</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use "summary" to obtain descriptive statistics</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  20.00   21.50   24.00   24.17   26.50   29.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame from the vector age:</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>age_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(age)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Use "descriptives" to obtain descriptive statistics for age_df</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(age_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 DESCRIPTIVES

 Descriptives                       
 ────────────────────────────────── 
                         age        
 ────────────────────────────────── 
   N                            6   
   Missing                      0   
   Mean                  24.16667   
   Median                24.00000   
   Standard deviation    3.488075   
   Minimum               20.00000   
   Maximum               29.00000   
 ────────────────────────────────── </code></pre>
</div>
</div>
</section>
<section id="plotting-data-by-another-variable" class="level2" data-number="2.30">
<h2 data-number="2.30" class="anchored" data-anchor-id="plotting-data-by-another-variable"><span class="header-section-number">2.30</span> Plotting data by another variable</h2>
<p>Unfortunately, it is not straight-forward to create separate plots for every level of another variable. We will demonstrate by plotting BMI by sex using our health survey data.</p>
<p>The following steps are not the most efficient way of doing this, but are easy to follow and understand. We first begin by creating two new data frames, for males and females separately, using the <code>subset()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>survey_males <span class="ot">&lt;-</span> <span class="fu">subset</span>(survey, sex<span class="sc">==</span><span class="st">"Male"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>survey_females <span class="ot">&lt;-</span> <span class="fu">subset</span>(survey, sex<span class="sc">==</span><span class="st">"Female"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that we use the <strong>label</strong> for sex, not the underlying numeric value, as sex is a <strong>factor</strong>.</p>
<p>We can now create hisotgrams and boxplots of BMI for males and females separately. To place the graphs next to each other in a single figure, we can use the <code>par</code> function, which sets the <em>graphics parameters</em>. Essentially, we want to tell R to split a plot window into a matrix with <em>nr</em> rows and <em>nc</em> columns, and we fill the cells by rows (<code>mfrow</code>) or columns (<code>mfcols</code>).</p>
<p>For example, to plot four figures in a single plot, filled by rows, we use <code>par(mfrow=c(2,2))</code>.</p>
<p>When we are done plotting multiple graphs, we can reset the graphics parameters by submitting <code>par(mfrow=c(1,1))</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the graphics parameters to plot 2 rows and 2 columns:</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify each plot separately</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(survey_males<span class="sc">$</span>bmi, <span class="at">xlab=</span><span class="st">"BMI (kg/m2)"</span>, <span class="at">main=</span><span class="st">"Males"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(survey_females<span class="sc">$</span>bmi, <span class="at">xlab=</span><span class="st">"BMI (kg/m2)"</span>, <span class="at">main=</span><span class="st">"Females"</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(survey_males<span class="sc">$</span>bmi, <span class="at">ylab=</span><span class="st">"BMI (kg/m2)"</span>, <span class="at">main=</span><span class="st">"Males"</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(survey_females<span class="sc">$</span>bmi, <span class="at">ylab=</span><span class="st">"BMI (kg/m2)"</span>, <span class="at">main=</span><span class="st">"Females"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-probability_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset graphics parameters</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-recoding-data" class="level2" data-number="2.31">
<h2 data-number="2.31" class="anchored" data-anchor-id="sec-recoding-data"><span class="header-section-number">2.31</span> Recoding data</h2>
<p>One task that is common in statistical computing is to recode variables. For example, we might want to group some categories of a categorical variable, or to present a continuous variable in a categorical way.</p>
<p>In this example, we can recode BMI into the following categories as suggested by the World Health Organisation [footnote]:</p>
<ul>
<li>Underweight: BMI &lt; 18.5</li>
<li>Normal weight: 18.5 <span class="math inline">\(\le\)</span> BMI &lt; 25</li>
<li>Pre-obesity: 25 <span class="math inline">\(\le\)</span> BMI &lt; 30</li>
<li>Obesity Class I: 30 <span class="math inline">\(\le\)</span> BMI &lt; 35</li>
<li>Obesity Class II: 35 <span class="math inline">\(\le\)</span> BMI &lt; 40</li>
<li>Obesity Class III: BMI <span class="math inline">\(\ge\)</span> 40</li>
</ul>
<p>The quickest way to recode a continuous variable into categories is to use the <code>cut</code> command which takes a continuous variable, and “cuts” it into groups based on the specified “cutpoints”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>bmi_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(survey<span class="sc">$</span>bmi, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">18.5</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that lower (BMI=0) and upper (BMI=100) bounds have been specified, as both a lower and upper limit must be defined for each group.</p>
<p>If we examine the new <code>bmi_cat</code> variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey<span class="sc">$</span>bmi_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (0,18.5] (18.5,25]   (25,30]   (30,35]   (35,40]  (40,100] 
       18       362       411       205        97        47 </code></pre>
</div>
</div>
<p>we see that each group has been labelled (a, b]. This notation is equivalent to: greater than a, and less than or equal to b. The <code>cut</code> function excludes the lower limit, but includes the upper limit. Our BMI ranges have been defined to include the lower limit, and exclude the upper limit (for example, greater than or equal to 30 and less than 35).</p>
<p>We can specify this recoding using the <code>right=FALSE</code> option:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>bmi_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(survey<span class="sc">$</span>bmi,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">18.5</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">100</span>),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">right=</span><span class="cn">FALSE</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey<span class="sc">$</span>bmi_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [0,18.5) [18.5,25)   [25,30)   [30,35)   [35,40)  [40,100) 
       18       362       411       201       101        47 </code></pre>
</div>
</div>
<p>Finally, we can specify labels for the groups using the <code>labels</code> option:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>bmi_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(survey<span class="sc">$</span>bmi,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">18.5</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">100</span>),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">right=</span><span class="cn">FALSE</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Underweight"</span>, <span class="st">"Normal"</span>, <span class="st">"Pre-obesity"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Obesity Class I"</span>, <span class="st">"Obesity Class II"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Obesity Class III"</span>))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey<span class="sc">$</span>bmi_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Underweight            Normal       Pre-obesity   Obesity Class I 
               18               362               411               201 
 Obesity Class II Obesity Class III 
              101                47 </code></pre>
</div>
</div>
</section>
<section id="computing-binomial-probabilities-using-r" class="level2" data-number="2.32">
<h2 data-number="2.32" class="anchored" data-anchor-id="computing-binomial-probabilities-using-r"><span class="header-section-number">2.32</span> Computing binomial probabilities using R</h2>
<p>There are two R functions that we can use to calculate probabilities based on the binomial distribution: <code>dbinom</code> and <code>pbinom</code>:</p>
<ul>
<li><code>dbinom(x, size, prob)</code> gives the probability of obtaining <code>x</code> successes from <code>size</code> trials when the probability of a success on one trial is <code>prob</code>;</li>
<li><code>pbinom(q, size, prob)</code> gives the probability of obtaining <code>q</code> <strong>or fewer</strong> successes from <code>size</code> trials when the probability of a success on one trial is <code>prob</code>;</li>
<li><code>pbinom(q, size, prob, lower.tail=FALSE)</code> gives the probability of obtaining <strong>more than</strong> <code>q</code>successes from <code>size</code> trials when the probability of a success on one trial is <code>prob</code>.</li>
</ul>
<p>To do the computation for part (a) in Worked Example 2.1, we will use the <code>dbinom</code> function with:</p>
<ul>
<li><em>x</em> is the number of successes, here, the number of smokers (i.e.&nbsp;k=3);</li>
<li><em>size</em> is the number of trials (i.e.&nbsp;n=6);</li>
<li>and <em>prob</em> is probability of drawing a smoker from the population, which is 19.8% (i.e.&nbsp;p=0.198).</li>
</ul>
<p>Replace each of these with the appropriate number into the formula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08008454</code></pre>
</div>
</div>
<p>To calculate the upper tail of probability in part (b), we use the <code>pbinom(lower.tail=FALSE)</code> function. Note that the <code>pbinom(lower.tail=FALSE)</code> function <strong>does not include <code>q</code></strong>, so to obtain 4 or more successes, we need to enter <code>q=3</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01635325</code></pre>
</div>
</div>
<p>For the lower tail for part (c), we use the <code>pbinom</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">2</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9035622</code></pre>
</div>
</div>
</section>
<section id="computing-probabilities-from-a-normal-distribution" class="level2" data-number="2.33">
<h2 data-number="2.33" class="anchored" data-anchor-id="computing-probabilities-from-a-normal-distribution"><span class="header-section-number">2.33</span> Computing probabilities from a Normal distribution</h2>
<p>We can use the <code>pnorm</code> function to calculate probabilities from a Normal distribution:</p>
<ul>
<li><code>pnorm(q, mean, sd)</code> calculates the probability of observing a value of <code>q</code> or less, from a Normal distribution with a mean of <code>mean</code> and a standard deviation of <code>sd</code>. Note that if <code>mean</code> and <code>sd</code> are not entered, they are assumed to be 0 and 1 respectively (i.e.&nbsp;a standard normal distribution.)</li>
<li><code>pnorm(q, mean, sd, lower.tail=FALSE)</code> calculates the probability of observing a value of more than <code>q</code>, from a Normal distribution with a mean of <code>mean</code> and a standard deviation of <code>sd</code>.</li>
</ul>
<p>To obtain the probability of obtaining 0.5 or greater from a standard normal distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">0.5</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3085375</code></pre>
</div>
</div>
<p>To calculate the worked example: Assume that the mean diastolic blood pressure for men is 77.9 mmHg, with a standard deviation of 11. What is the probability that a man selected at random will have high blood pressure (i.e.&nbsp;diastolic blood pressure greater than or equal to 90)?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="fl">77.9</span>, <span class="at">sd=</span><span class="dv">11</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1356661</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="activities" class="level1 unnumbered">
<h1 class="unnumbered">Activities</h1>
<section id="activity-2.1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-2.1">Activity 2.1</h3>
<p>In a Randomised Controlled Trial, the preference of a new drug was tested against an established drug by giving both drugs to each of 90 people. Assume that the two drugs are equally preferred, that is, the probability that a patient prefers either of the drugs is equal (50%). Use one of the binomial functions in Stata or R to compute the probability that 60 or more patients would prefer the new drug. In completing this question, determine:</p>
<ol type="a">
<li>The number of trials (<code>n</code> for Stata, <code>size</code> for R)</li>
<li>The number of successes we are interested in (<code>k</code> for Stata, <code>x</code> or <code>q</code> for R)</li>
<li>The probability of success for each trial (<code>p</code> for Stata, <code>prob</code> for R)</li>
<li>The form of the binomial function
<ul>
<li>for Stata: <code>binomialp</code>, <code>binomial</code> or <code>binomialtail</code>;</li>
<li>for R: <code>dbinom</code>, <code>pbinom</code> or <code>pbinom(lower.tail=FALSE)</code></li>
</ul></li>
<li>The final probability.</li>
</ol>
</section>
<section id="activity-2.2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-2.2">Activity 2.2</h3>
<p>A case of Schistosomiasis is identified by the detection of schistosome ova in a faecal sample. In patients with a low level of infection, a field technique of faecal examination has a probability of 0.35 of detecting ova in any one faecal sample. If five samples are routinely examined for each patient, use Stata or R to compute the probability that a patient with a low level of infection:</p>
<ol type="a">
<li>Will not be identified?</li>
<li>Will be identified in two of the samples?</li>
<li>Will be identified in all the samples?</li>
<li>Will be identified in at most 3 of the samples?</li>
</ol>
</section>
<section id="activity-2.3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-2.3">Activity 2.3</h3>
<p>If weights of men are Normally distributed with a population mean <span class="math inline">\(\mu\)</span> = 87, and a population standard deviation, <span class="math inline">\(\sigma\)</span> = 8 kg:</p>
<ol type="a">
<li>What is the probability that a man will weigh 95 kg or more? Draw a Normal curve of the area represented by this probability in the population (i.e.&nbsp;with <span class="math inline">\(\mu\)</span> = 87 kg and <span class="math inline">\(\sigma\)</span> = 8 kg).</li>
<li>What is the probability that a man will weigh more than 75 kg but less than 95 kg? Draw the area represented by this probability on a Normal curve.</li>
</ol>
</section>
<section id="activity-2.4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-2.4">Activity 2.4</h3>
<p>Using the health survey data (<code>Activity_S2.4.xlsx</code>) described in the computing notes of this module, create a new variable, BMI, which is equal to a person’s weight (in kg) divided by their height (in metres) squared (i.e.&nbsp;<span class="math inline">\(\text{BMI} = \frac{\text{weight (kg)}}{\text{[height (m)]}^2}\)</span>. Categorise BMI using the WHO categories:</p>
<ul>
<li>Underweight: BMI &lt; 18.5</li>
<li>Normal weight: 18.5 <span class="math inline">\(\le\)</span> BMI &lt; 25</li>
<li>Pre-obesity: 25 <span class="math inline">\(\le\)</span> BMI &lt; 30</li>
<li>Obesity Class I: 30 <span class="math inline">\(\le\)</span> BMI &lt; 35</li>
<li>Obesity Class II: 35 <span class="math inline">\(\le\)</span> BMI &lt; 40</li>
<li>Obesity Class III: BMI <span class="math inline">\(\ge\)</span> 40</li>
</ul>
<p>Create a two-way table to display the distribution of BMI categories by sex (sex: 1 = respondent identifies as male; 2 = respondent identifies as female). Does there appear to be a difference in categorised BMI between males and females?</p>
</section>
<section id="activity-2.5" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-2.5">Activity 2.5</h3>
<p>The data in the files <code>Activity_S2.5.dta</code> and <code>Activity_S2.5.rds</code> (available on Moodle) has information about birth weight and length of stay collected from 117 babies admitted consecutively to a hospital for surgery. For each variable:</p>
<ol type="a">
<li><p>Create a histogram to inspect the distribution of the variable;</p></li>
<li><p>Complete the following summary statistics for each variable:</p>
<ul>
<li>mean and median;</li>
<li>standard deviation and interquartile range;</li>
<li>skewness and kurtosis.</li>
</ul></li>
</ol>
<p>Make a decision about whether each variable is symmetric or not, and which measure of central tendency and variability should be reported.</p>
</section>
<section id="activity-2.6" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-2.6">Activity 2.6</h3>
<p>The data set of hospital stay data for 1323 hypothetical patients is available on Moodle in csv format (<code>Activity2.6.csv</code>). Import this dataset into Stata or R. There are two variables in this dataset:</p>
<ul>
<li>female: female=1; male=0</li>
<li>los: length of stay in days</li>
</ul>
<ol type="a">
<li>Use Stata or R to examine the distribution of length of stay: overall; and separately for females and males. Comment on the distributions.</li>
<li>Use Stata or R to calculate measures of central tendency for hospital stay to obtain information about the average duration of hospital stay. Which summary statistics should you report and why? Report the appropriate statistics of the spread and measure of central tendency chosen.</li>
<li>Calculate the measures of central tendency for hospital duration separately for males and females. What can you conclude from comparing these measures for males and females?</li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-bland15" class="csl-entry" role="listitem">
Bland, Martin. 2015. <em>An <span>Introduction</span> to <span>Medical Statistics</span></em>. 4th Edition. Oxford, New York: Oxford University Press.
</div>
<div id="ref-kirkwood_sterne01" class="csl-entry" role="listitem">
Kirkwood, Betty, and Jonathan Sterne. 2001. <em>Essentials of <span>Medical Statistics</span></em>. 2nd edition. Malden, Mass: Wiley-Blackwell.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Source: https://www.aihw.gov.au/reports/risk-factors/high-blood-pressure/contents/high-blood-pressure (accessed March 2021)<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Source: https://ourworldindata.org/human-height (accessed March 2021)<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./_revision-progress.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">_revision-progress.html</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-comparing-two-means.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Comparing the means of two groups</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>